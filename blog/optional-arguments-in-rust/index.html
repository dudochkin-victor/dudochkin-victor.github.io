<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ Rust | Dudochkin Victor </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="google-site-verification" content="Kepqb6k6uptlwngnHbBVJmqQtwNW8zfHyQBbTXLYAgA" />
    <meta name="yandex-verification" content="8e8bc73c2566b473" />
    <style>
    :root {
        /* Primary theme color */
        /* --primary-color: #121A26; */
        --primary-color: #0f1419;
        /* Primary theme text color */
        /* --primary-text-color: #121A26; */
        --primary-text-color: #0f1419;
        /* Primary theme link color */
        --primary-link-color: #053961;
        /* Secondary color: the background body color */
        --secondary-color: #F0F0F0;
        --secondary-text-color: #1C2834;
        /* Highlight text color of table of content */
        --toc-highlight-text-color: #053961;
    }
</style>
    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-47MMPLLY44"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-47MMPLLY44');
    </script>
    

    
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript" >
        (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
        (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
    
        ym('87064264', "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true
        });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/87064264" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
    
    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/mdl.min.css">
    <link rel="stylesheet" href="https://dudochkin-victor.github.io/style.css">
    
    
</head>

<body>
    
<header class="box-shadow">
    

<a href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;">
    <div class="logo">
        <img src="https://dudochkin-victor.github.io/ferris.png" alt="logo">
        Dudochkin Victor
    </div>
</a>

<nav>
    <!-- 
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;showcases&#x2F;">Showcases</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;changelog&#x2F;">Changelog</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;about&#x2F;">About</a>
     -->

    
        
        <a class="nav-item subtitle-text" href="&#x2F;solana&#x2F;">Solana</a>
        
        <a class="nav-item subtitle-text" href="&#x2F;edgeware&#x2F;">Edgeware</a>
        
        <a class="nav-item subtitle-text" href="&#x2F;blog&#x2F;">–ë–ª–æ–≥</a>
        
        <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;github.com&#x2F;dudochkin-victor">Github</a>
        
    
</nav>

</header>

 
    <main>
        
        
        
        
        
        <div class="toc">
            <div class="toc-sticky">
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/blog/optional-arguments-in-rust/#u-nas-net-znakov-ili-mnozhestvennykh-realizatsii">–£ –Ω–∞—Å –Ω–µ—Ç –∑–Ω–∞–∫–æ–≤ –∏–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/blog/optional-arguments-in-rust/#prosto-dobav-te-eshche-odnu-funktsiiu">–ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ –µ—â–µ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é!</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/blog/optional-arguments-in-rust/#u-nas-est-varianty">–£ –Ω–∞—Å –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/blog/optional-arguments-in-rust/#v-storonu-pochemu-mne-nravitsia-impl-trait">–í —Å—Ç–æ—Ä–æ–Ω—É: –ø–æ—á–µ–º—É –º–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è impl Trait</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/blog/optional-arguments-in-rust/#obshchaia-realizatsiia">–û–±—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/blog/optional-arguments-in-rust/#predosterezheniia">–ü—Ä–µ–¥–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–∏—è</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/blog/optional-arguments-in-rust/#benchmarking">–ë–µ–Ω—á–º–∞—Ä–∫–∏–Ω–≥</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/blog/optional-arguments-in-rust/#chto-my-uznali-i-vyvody">–ß—Ç–æ –º—ã —É–∑–Ω–∞–ª–∏ –∏ –≤—ã–≤–æ–¥—ã</a>
                </div>
                
                
            </div>
        </div>
        
        

        <div class="content text">
            
<h1>–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ Rust</h1>

<p><a href="https://hoverbear.org/blog/optional-arguments/">–ü–µ—Ä–µ–≤–æ–¥</a> | –ê–≤—Ç–æ—Ä –æ—Ä–∏–≥–∏–Ω–∞–ª–∞: Ana Hoverbear</p>
<p>–ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ API –¥–ª—è –≤–∞—à–µ–≥–æ –∫—Ä—ç–π—Ç–∞ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –æ–¥–Ω–∞ —Ç–µ–º–∞ - –∫–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã. –î–∞–≤–∞–π—Ç–µ –∏–∑—É—á–∏–º –Ω–∞—à–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤ Rust!</p>
<h2 id="u-nas-net-znakov-ili-mnozhestvennykh-realizatsii">–£ –Ω–∞—Å –Ω–µ—Ç –∑–Ω–∞–∫–æ–≤ –∏–ª–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π</h2>
<p>–í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è Rust –Ω–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–π —Å –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω—ã–º–∏ –∏–ª–∏ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ: </p>
<pre data-lang="rust" style="background-color:#0f1419;color:#bfbab0;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">impossible</span><span>(</span><span style="color:#f29718;">val</span><span style="color:#bfbab0cc;">: </span><span style="color:#ff7733;">bool</span><span>) {}
</span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">impossible</span><span>(</span><span style="color:#f29718;">val</span><span style="color:#bfbab0cc;">: </span><span style="color:#ff7733;">bool</span><span>, </span><span style="color:#f29718;">other</span><span style="color:#bfbab0cc;">: </span><span style="color:#ff7733;">bool</span><span>) {}
</span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">impossible</span><span>(</span><span style="color:#f29718;">val</span><span style="color:#bfbab0cc;">: </span><span style="color:#ff7733;">bool</span><span>, </span><span style="color:#f29718;">rest</span><span style="color:#bfbab0cc;">: </span><span style="color:#ff7733;">bool</span><span>...) {}
</span></code></pre>
<p>–ü–µ—Ä–µ—Ö–æ–¥—è —Å —Ç–∞–∫–∏—Ö —è–∑—ã–∫–æ–≤, –∫–∞–∫ JS –∏–ª–∏ Ruby, –≤—ã –º–æ–∂–µ—Ç–µ —É–ø—É—Å—Ç–∏—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, —è —á–∞—Å—Ç–æ –∏—Å–∫–∞–ª —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ. </p>
<pre data-lang="rust" style="background-color:#0f1419;color:#bfbab0;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="font-style:italic;color:#5c6773;">// In the context of an configuration structure for a client:
</span><span>client</span><span style="color:#f29668;">.</span><span style="color:#f07178;">connect</span><span>(</span><span style="color:#c2d94c;">&quot;127.0.0.1&quot;</span><span>)</span><span style="color:#f29668;">?</span><span style="color:#bfbab0cc;">;
</span><span>client</span><span style="color:#f29668;">.</span><span style="color:#f07178;">connect</span><span>(</span><span style="color:#c2d94c;">&quot;127.0.0.1&quot;</span><span style="color:#bfbab0cc;">,</span><span> custom_config)</span><span style="color:#f29668;">?</span><span style="color:#bfbab0cc;">;
</span></code></pre>
<blockquote>
<p>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±–ª–∞—Å—Ç–∏ –¥–µ–π—Å—Ç–≤–∏—è: –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –º–Ω–µ –Ω–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –ø–∏—Å–∞—Ç—å –æ —Ç–æ–º, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏. –ï—Å–ª–∏ –≤–∞–º —ç—Ç–æ –Ω–µ —Ç–µ—Ä–ø–∏—Ç—Å—è, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∞–º–∏, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –º–∞–∫—Ä–æ—Å, —Å–ø—Ä–∞–≤–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç!().</p>
</blockquote>
<h2 id="prosto-dobav-te-eshche-odnu-funktsiiu">–ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ –µ—â–µ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é!</h2>
<p>–ï—Å–ª–∏ —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, –∫–∞–∫–æ–≤–∞ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞?</p>
<p>–°–∞–º—ã–π –æ—á–µ–≤–∏–¥–Ω—ã–π - –∏–º–µ—Ç—å –¥–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –≤ —ç—Ç–æ–º –Ω–µ—Ç –Ω–∏—á–µ–≥–æ –ø–ª–æ—Ö–æ–≥–æ. –≠—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —Ä–∞–∑—É–º–Ω–æ –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—á–µ–Ω—å –ø—Ä–∏–µ–º–ª–µ–º–æ–º—É API. –ù–∏–∫–∞–∫–∏—Ö —É–ª–æ–≤–æ–∫, –∏ —ç—Ç–æ —Å—Ä–∞–∑—É –ø–æ–Ω—è—Ç–Ω–æ: </p>
<pre data-lang="rust" style="background-color:#0f1419;color:#bfbab0;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">connect</span><span>(</span><span style="color:#f29718;">addr</span><span style="color:#bfbab0cc;">:</span><span> String) </span><span style="color:#bfbab0cc;">-&gt; </span><span style="font-style:italic;color:#39bae6;">Result</span><span>&lt;</span><span style="color:#ff7733;">Self</span><span>, io</span><span style="color:#f29668;">::</span><span>Error&gt; {
</span><span>    </span><span style="color:#ff7733;">Self</span><span style="color:#f29668;">::</span><span>connect_with_config(addr</span><span style="color:#bfbab0cc;">, </span><span>Config</span><span style="color:#f29668;">::</span><span>default())
</span><span>}
</span><span>
</span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">connect_with_config</span><span>(</span><span style="color:#f29718;">addr</span><span style="color:#bfbab0cc;">:</span><span> String, </span><span style="color:#f29718;">config</span><span style="color:#bfbab0cc;">:</span><span> Config) </span><span style="color:#bfbab0cc;">-&gt; </span><span style="font-style:italic;color:#39bae6;">Result</span><span>&lt;</span><span style="color:#ff7733;">Self</span><span>, io</span><span style="color:#f29668;">::</span><span>Error&gt; {
</span><span>    </span><span style="font-style:italic;color:#5c6773;">// ...
</span><span>}
</span></code></pre>
<p>–ù–æ —ç—Ç–æ –æ—á–µ–Ω—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–º–µ—Ä. –ò–Ω–æ–≥–¥–∞ –±—ã–≤–∞—é—Ç –æ–±—â–∏–µ —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ —ç—Ç–æ –Ω–µ —Ç–∞–∫ —Ä–∞–∑—É–º–Ω–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏, –∫–æ—Ç–æ—Ä–æ–µ –æ–±—ã—á–Ω–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –Ω–æ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≤—è–∑–∏). –ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Ç–µ—Ö–Ω–∏–∫–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Å—Ç—Ä–∞–Ω–Ω–æ: –≤—ã –ª–∏–±–æ –ø–æ–ª—É—á–∞–µ—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å message_with_payload() –≤–µ–∑–¥–µ, –ª–∏–±–æ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π ping(), –ª–∏–±–æ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π message_without_payload(). –ò—Å–ø–æ–ª—å–∑—É—è —Å–≤–æ–µ –≤–æ–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≤—ã –º–æ–≥–ª–∏ –±—ã –ø—Ä–∏–¥—É–º–∞—Ç—å –¥—Ä—É–≥–∏–µ –ø—Ä–∏–º–µ—Ä—ã –≤ –≤–∞—à–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º –∫–æ–¥–µ, –≥–¥–µ –≤—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å —ç—Ç–∏–º. </p>
<h2 id="u-nas-est-varianty">–£ –Ω–∞—Å –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã</h2>
<p>–°–ª–µ–¥—É—é—â–∏–º –ª–æ–≥–∏—á–µ—Å–∫–∏–º —à–∞–≥–æ–º, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—á–∏–Ω–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ Rust, —è–≤–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–∏–ø–∞. </p>
<pre data-lang="rust" style="background-color:#0f1419;color:#bfbab0;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">message</span><span>(</span><span style="color:#f29718;">addr</span><span style="color:#bfbab0cc;">:</span><span> String, </span><span style="color:#f29718;">maybe_payload</span><span style="color:#bfbab0cc;">: </span><span style="font-style:italic;color:#39bae6;">Option</span><span>&lt;</span><span style="font-style:italic;color:#39bae6;">Vec</span><span>&lt;</span><span style="color:#ff7733;">u8</span><span>&gt;&gt;) </span><span style="color:#bfbab0cc;">-&gt; </span><span style="font-style:italic;color:#39bae6;">Result</span><span>&lt;</span><span style="color:#ff7733;">u64</span><span>, io</span><span style="color:#f29668;">::</span><span>Error&gt; {
</span><span>    </span><span style="font-style:italic;color:#5c6773;">// ...
</span><span>    </span><span style="color:#ff7733;">if let </span><span style="font-style:italic;color:#39bae6;">Some</span><span>(payload) </span><span style="color:#f29668;">=</span><span> maybe_payload {
</span><span>        </span><span style="font-style:italic;color:#5c6773;">// Off you go...
</span><span>    }
</span><span>    </span><span style="font-style:italic;color:#5c6773;">// ...
</span><span>}
</span><span style="font-style:italic;color:#5c6773;">// Using it:
</span><span style="color:#f07178;">message</span><span>(</span><span style="color:#c2d94c;">&quot;127.0.0.1&quot;</span><span style="color:#bfbab0cc;">, </span><span style="font-style:italic;color:#39bae6;">Some</span><span>(</span><span style="color:#f07178;">vec!</span><span>[</span><span style="color:#f29718;">1</span><span style="color:#bfbab0cc;">,</span><span style="color:#f29718;">2</span><span style="color:#bfbab0cc;">,</span><span style="color:#f29718;">3</span><span>]))</span><span style="color:#f29668;">?</span><span style="color:#bfbab0cc;">;
</span><span style="color:#f07178;">message</span><span>(</span><span style="color:#c2d94c;">&quot;127.0.0.1&quot;</span><span style="color:#bfbab0cc;">, </span><span style="font-style:italic;color:#39bae6;">None</span><span>)</span><span style="color:#f29668;">?</span><span style="color:#bfbab0cc;">;
</span></code></pre>
<p>–≠—Ç–æ, –±–µ–∑—É—Å–ª–æ–≤–Ω–æ, –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É! –¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, —É–∫–∞–∑–∞–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ –Ω–µ—Ç. –≠—Ç–æ –Ω–µ–º–Ω–æ–≥–æ –∑–∞–≥—Ä–æ–º–æ–∂–¥–∞–µ—Ç API, –Ω–æ, –ø–æ—Ö–æ–∂–µ, —Ç–µ–ø–µ—Ä—å —É –Ω–∞—Å –≤–æ–∑–Ω–∏–∫–ª–æ —Å—Ç—Ä–∞–Ω–Ω–æ–µ –æ—â—É—â–µ–Ω–∏–µ, —á—Ç–æ –≤–∞—Ä–∏–∞–Ω—Ç—ã Some(_) –∏ None —Å–ª–æ–Ω—è—é—Ç—Å—è –ø–æ —Å—Ç–æ—Ä–æ–Ω–∞–º.</p>
<p>–ú—ã —Ä–µ—à–∞–µ–º –ø—Ä–æ–±–ª–µ–º—É —Å –ø–æ–º–æ—â—å—é –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, —á–µ–≥–æ –º—ã –ø—ã—Ç–∞–µ–º—Å—è –¥–æ—Å—Ç–∏—á—å, –∏ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–∏–∫—Ä–æ–±–µ–Ω—á–º–∞—Ä–∫–æ–≤. </p>
<pre data-lang="rust" style="background-color:#0f1419;color:#bfbab0;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">value_arg</span><span>&lt;Thing&gt;(</span><span style="color:#f29718;">thing</span><span style="color:#bfbab0cc;">:</span><span> Thing) </span><span style="color:#bfbab0cc;">-&gt;</span><span> Thing {
</span><span>    thing
</span><span>}
</span><span>
</span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">optional_arg</span><span>&lt;Thing&gt;(</span><span style="color:#f29718;">thing</span><span style="color:#bfbab0cc;">: </span><span style="font-style:italic;color:#39bae6;">Option</span><span>&lt;Thing&gt;) </span><span style="color:#bfbab0cc;">-&gt;</span><span> Thing
</span><span style="color:#ff7733;">where</span><span> Thing</span><span style="color:#bfbab0cc;">:</span><span> Default {
</span><span>    thing</span><span style="color:#f29668;">.</span><span style="color:#f07178;">unwrap_or</span><span>(Thing</span><span style="color:#f29668;">::</span><span>default())
</span><span>}
</span></code></pre>
<p>–ö–∞–∫ –≤–∏–¥–∏—Ç–µ, –æ–Ω–∏ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã, –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–æ –Ω–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Ö, –æ–Ω–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∏—Å–ø—ã—Ç–∞—Ç–µ–ª—é –ø—Ä–∏–Ω—è—Ç—å –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç.</p>
<p>–î–∞–≤–∞–π—Ç–µ –∏–∑–±–∞–≤–∏–º—Å—è –æ—Ç Some(_). –ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∂–µ–Ω–µ—Ä–∏–∫–∏ —á–µ—Ä–µ–∑ impl Trait, inline generic –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è where.</p>
<h2 id="v-storonu-pochemu-mne-nravitsia-impl-trait">–í —Å—Ç–æ—Ä–æ–Ω—É: –ø–æ—á–µ–º—É –º–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è impl Trait</h2>
<p>–Ø –¥—É–º–∞—é, —á—Ç–æ —ç—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–æ–ª–µ–µ –ª–∞–∫–æ–Ω–∏—á–Ω—ã–π —Å—Ç–∏–ª—å, –ª—É—á—à—É—é —Å–µ–º–∞–Ω—Ç–∏–∫—É –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –æ–¥–Ω–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ—à–∏–±–∫–∏ —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—É—é –ª–µ–≥–∫–æ —Å–¥–µ–ª–∞—Ç—å. –£—á—Ç–∏—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ: </p>
<pre data-lang="rust" style="background-color:#0f1419;color:#bfbab0;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">handles_a_pair_of_stringish</span><span>&lt;Stringish&gt;(</span><span style="color:#f29718;">first</span><span style="color:#bfbab0cc;">:</span><span> Stringish, </span><span style="color:#f29718;">second</span><span style="color:#bfbab0cc;">:</span><span> Stringish)
</span><span style="color:#ff7733;">where</span><span> Stringish</span><span style="color:#bfbab0cc;">: </span><span style="font-style:italic;color:#39bae6;">AsRef</span><span>&lt;</span><span style="color:#ff7733;">str</span><span>&gt; {
</span><span>    </span><span style="font-style:italic;color:#5c6773;">// ...
</span><span>}
</span><span>
</span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">handles_a_pair_of_varying_stringish</span><span>(</span><span style="color:#f29718;">first</span><span style="color:#bfbab0cc;">:</span><span> impl </span><span style="font-style:italic;color:#39bae6;">AsRef</span><span>&lt;</span><span style="color:#ff7733;">str</span><span>&gt;, </span><span style="color:#f29718;">second</span><span style="color:#bfbab0cc;">:</span><span> impl </span><span style="font-style:italic;color:#39bae6;">AsRef</span><span>&lt;</span><span style="color:#ff7733;">str</span><span>&gt;) {
</span><span>    </span><span style="font-style:italic;color:#5c6773;">// ...
</span><span>}
</span><span>
</span><span style="color:#bfbab0cc;">#</span><span>[</span><span style="color:#ffb454;">test</span><span>]
</span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">send_stringishes_of_difference_type</span><span>() {
</span><span>    </span><span style="color:#f07178;">handles_a_pair_of_stringish</span><span>(</span><span style="color:#c2d94c;">&quot;foo&quot;</span><span style="color:#f29668;">.</span><span style="color:#f07178;">to_string</span><span>()</span><span style="color:#bfbab0cc;">, </span><span style="color:#c2d94c;">&quot;foo&quot;</span><span>)</span><span style="color:#bfbab0cc;">; </span><span style="font-style:italic;color:#5c6773;">// This won&#39;t compile!
</span><span>    </span><span style="color:#f07178;">handles_a_pair_of_varying_stringish</span><span>(</span><span style="color:#c2d94c;">&quot;foo&quot;</span><span style="color:#f29668;">.</span><span style="color:#f07178;">to_string</span><span>()</span><span style="color:#bfbab0cc;">, </span><span style="color:#c2d94c;">&quot;foo&quot;</span><span>)</span><span style="color:#bfbab0cc;">;
</span><span>}
</span></code></pre>
<p>–Ø –¥—É–º–∞—é, —á—Ç–æ –≤ —Ç–∞–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö impl Trait - —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ –≥–∏–±–∫–æ—Å—Ç–∏. –Ø –Ω–µ –ø—Ä–∏–∑—ã–≤–∞—é –≤–∞—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤–µ–∑–¥–µ –∏ –≤–µ–∑–¥–µ. –°—Ç—Ä–µ–º–∏—Ç–µ—Å—å –∫ —É–¥–æ–±–æ—á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ –ø–æ–Ω—è—Ç–Ω–æ—Å—Ç–∏, –∞ –Ω–µ –∫ &quot;–≥–ª–∞–¥–∫–∏–º&quot; / –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–º API.</p>
<h2 id="obshchaia-realizatsiia">–û–±—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</h2>
<p>–ß—Ç–æ–±—ã —É–ª—É—á—à–∏—Ç—å —ç—Ç–æ—Ç –¥–∏–∑–∞–π–Ω, –º—ã –º–æ–∂–µ–º –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–µ–π—Ç–æ–≤: </p>
<ul>
<li>impl<T> Into&lt;Option<T>&gt; for T</li>
<li>impl<T> Default for Option<T></li>
</ul>
<p>–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –º–æ–∂–µ–º –¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:</p>
<pre data-lang="rust" style="background-color:#0f1419;color:#bfbab0;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">optional_arg_with_into</span><span>&lt;Thing&gt;(
</span><span>    </span><span style="color:#f29718;">thing</span><span style="color:#bfbab0cc;">:</span><span> impl </span><span style="font-style:italic;color:#39bae6;">Into</span><span>&lt;</span><span style="font-style:italic;color:#39bae6;">Option</span><span>&lt;Thing&gt;&gt;
</span><span>) </span><span style="color:#bfbab0cc;">-&gt;</span><span> Thing
</span><span style="color:#ff7733;">where</span><span> Thing</span><span style="color:#bfbab0cc;">:</span><span> Default {
</span><span>    thing</span><span style="color:#f29668;">.</span><span style="color:#f07178;">into</span><span>()</span><span style="color:#f29668;">.</span><span style="color:#f07178;">unwrap_or</span><span>(Thing</span><span style="color:#f29668;">::</span><span>default())
</span><span>}
</span><span>
</span><span style="color:#bfbab0cc;">#</span><span>[</span><span style="color:#ffb454;">test</span><span>]
</span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">verify_assemptions</span><span>() {
</span><span>    </span><span style="color:#f07178;">optional_arg_with_into</span><span>(</span><span style="font-style:italic;color:#39bae6;">Vec</span><span style="color:#bfbab0cc;">::</span><span>&lt;</span><span style="color:#ff7733;">u64</span><span>&gt;</span><span style="color:#f29668;">::</span><span>default())</span><span style="color:#bfbab0cc;">;
</span><span>    </span><span style="color:#f07178;">optional_arg_with_into</span><span>(</span><span style="color:#f07178;">vec!</span><span>[</span><span style="color:#f29718;">1_</span><span style="color:#ff7733;">u64</span><span style="color:#bfbab0cc;">, </span><span style="color:#f29718;">2</span><span style="color:#bfbab0cc;">, </span><span style="color:#f29718;">3</span><span>])</span><span style="color:#bfbab0cc;">;
</span><span>    </span><span style="color:#ff7733;">let</span><span> out</span><span style="color:#bfbab0cc;">: </span><span style="font-style:italic;color:#39bae6;">Vec</span><span>&lt;</span><span style="color:#ff7733;">u64</span><span>&gt; </span><span style="color:#f29668;">= </span><span style="color:#f07178;">optional_arg_with_into</span><span>(</span><span style="font-style:italic;color:#39bae6;">None</span><span style="color:#bfbab0cc;">::</span><span>&lt;</span><span style="font-style:italic;color:#39bae6;">Vec</span><span>&lt;</span><span style="color:#ff7733;">u64</span><span>&gt;&gt;)</span><span style="color:#bfbab0cc;">; </span><span style="font-style:italic;color:#5c6773;">// Type hinting
</span><span>}
</span></code></pre>
<p>–í —ç—Ç–æ–º –æ—á–µ–Ω—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º –∫–æ–¥–µ –Ω–∞–º –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –¥–æ–≤–æ–ª—å–Ω–æ –º–Ω–æ–≥–æ –ø–æ–¥—Å–∫–∞–∑–æ–∫ —Ç–∏–ø–∞ –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞ None. –û–±—ã—á–Ω–æ —ç—Ç–æ –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –±–æ–ª—å—à–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å –Ω–µ—Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ–π –∫–æ–¥–æ–≤–æ–π –±–∞–∑–æ–π.</p>
<p>–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä—É –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ From), —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤–∞—à–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–æ–ª–µ–µ –≥–∏–±–∫–∏–π API.</p>
<h2 id="predosterezheniia">–ü—Ä–µ–¥–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–∏—è</h2>
<p>–ö–∞–∫ –≤—ã –º–æ–≥–ª–∏ –∑–∞–º–µ—Ç–∏—Ç—å –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º –ø—Ä–∏–º–µ—Ä–µ, –≤ —Å–ª—É—á–∞–µ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–≥–æ –∫–æ–¥–∞ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–≤–æ–ª—å–Ω–æ –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω—ã–º. –≠—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ –º—ã –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º —Å –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ / –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏. –ü–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –ø–æ–¥—Å–∫–∞–∑–∫–∞—Ö –∏—Å—á–µ–∑–Ω–µ—Ç, —Ç–∞–∫ –∫–∞–∫ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å–º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –±–æ–ª—å—à–µ –≤—ã–≤–æ–¥–æ–≤ –æ —Ç–∏–ø–∞—Ö –≤–µ—â–µ–π.</p>
<p>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–π —Ç–µ—Ö–Ω–∏–∫–∏ –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å –≤–∞—à—É —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –≥–∏–±–∫–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –≤–µ—â–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç—Å—è –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç. –ù–∞–ø—Ä–∏–º–µ—Ä, a U, –≥–¥–µ <code>impl From&lt;U&gt; for T</code>. –í–æ–∑–º–æ–∂–Ω–æ, –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –ø–µ—Ä–µ–ø—Ä—ã–≥–Ω—É—Ç—å —á–µ—Ä–µ–∑ –æ–±—Ä—É—á–∏. –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –æ–±–æ–π—Ç–∏ —ç—Ç–æ –∑–∞—Å—Ç–∞–≤–∏—Ç –≤–∞—à–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <code>T::from (u)</code> –≤ –ø–æ–∑–∏—Ü–∏–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –Ω–µ —Ç–∞–∫ —É–∂ –∏ –ø–ª–æ—Ö–æ.</p>
<h2 id="benchmarking">–ë–µ–Ω—á–º–∞—Ä–∫–∏–Ω–≥</h2>
<p>–î–∞–≤–∞–π—Ç–µ –∂–µ —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —ç—Ç–æ–π –≥–∏–±–∫–æ—Å—Ç–∏ –Ω–µ —Å–∏–ª—å–Ω–æ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞—à–µ–≥–æ –∫–æ–¥–∞. –Ø –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª Criterion –∏ –Ω–∞–ø–∏—Å–∞–ª –Ω–µ–±–æ–ª—å—à–æ–π –Ω–∞–±–æ—Ä –¥–ª—è –Ω–∞—à–µ–≥–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞. –ü–æ—Å–∫–æ–ª—å–∫—É –∫–æ–¥ —Ç—Ä–∏–≤–∏–∞–ª–µ–Ω (–æ–Ω –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ), –º—ã –º–æ–∂–µ–º –∏–∑—É—á–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏. –í–æ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–¥ —Å—Ç–µ–Ω–¥–∞: </p>
<pre data-lang="rust" style="background-color:#0f1419;color:#bfbab0;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#bfbab0cc;">#</span><span>[</span><span style="color:#ffb454;">macro_use</span><span>(criterion_main</span><span style="color:#bfbab0cc;">,</span><span> criterion_group)] </span><span style="color:#ff7733;">extern crate</span><span> criterion</span><span style="color:#bfbab0cc;">;
</span><span style="color:#ff7733;">use </span><span>criterion</span><span style="color:#f29668;">::</span><span>Criterion</span><span style="color:#bfbab0cc;">;
</span><span>
</span><span style="color:#f07178;">criterion_main!</span><span>(benches)</span><span style="color:#bfbab0cc;">;
</span><span style="color:#f07178;">criterion_group!</span><span>(benches</span><span style="color:#bfbab0cc;">, </span><span>optional_args</span><span style="color:#f29668;">::</span><span>group)</span><span style="color:#bfbab0cc;">;
</span><span>
</span><span style="color:#ff7733;">mod </span><span style="color:#59c2ff;">optional_args </span><span>{
</span><span>    </span><span style="color:#ff7733;">use </span><span>criterion</span><span style="color:#f29668;">::</span><span>Criterion</span><span style="color:#bfbab0cc;">;
</span><span>
</span><span>    </span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">value_arg</span><span>&lt;Thing&gt;(</span><span style="color:#f29718;">thing</span><span style="color:#bfbab0cc;">:</span><span> Thing) </span><span style="color:#bfbab0cc;">-&gt;</span><span> Thing {
</span><span>        thing
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">optional_arg</span><span>&lt;Thing&gt;(</span><span style="color:#f29718;">thing</span><span style="color:#bfbab0cc;">: </span><span style="font-style:italic;color:#39bae6;">Option</span><span>&lt;Thing&gt;) </span><span style="color:#bfbab0cc;">-&gt;</span><span> Thing
</span><span>    </span><span style="color:#ff7733;">where</span><span> Thing</span><span style="color:#bfbab0cc;">:</span><span> Default {
</span><span>        thing</span><span style="color:#f29668;">.</span><span style="color:#f07178;">unwrap_or</span><span>(Thing</span><span style="color:#f29668;">::</span><span>default())
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">optional_arg_with_into</span><span>&lt;Thing&gt;(
</span><span>        </span><span style="color:#f29718;">thing</span><span style="color:#bfbab0cc;">:</span><span> impl </span><span style="font-style:italic;color:#39bae6;">Into</span><span>&lt;</span><span style="font-style:italic;color:#39bae6;">Option</span><span>&lt;Thing&gt;&gt;
</span><span>    ) </span><span style="color:#bfbab0cc;">-&gt;</span><span> Thing
</span><span>    </span><span style="color:#ff7733;">where</span><span> Thing</span><span style="color:#bfbab0cc;">:</span><span> Default {
</span><span>        thing</span><span style="color:#f29668;">.</span><span style="color:#f07178;">into</span><span>()</span><span style="color:#f29668;">.</span><span style="color:#f07178;">unwrap_or</span><span>(Thing</span><span style="color:#f29668;">::</span><span>default())
</span><span>    }
</span><span>
</span><span>    </span><span style="color:#ff7733;">pub</span><span>(</span><span style="color:#ff7733;">crate</span><span>) </span><span style="color:#ff7733;">fn </span><span style="color:#ffb454;">group</span><span>(</span><span style="color:#f29718;">c</span><span style="color:#bfbab0cc;">: </span><span style="color:#f29668;">&amp;</span><span style="color:#ff7733;">mut</span><span> Criterion) {
</span><span>        c</span><span style="color:#f29668;">.</span><span style="color:#f07178;">bench_function</span><span>(</span><span style="color:#c2d94c;">&quot;value 1_u64&quot;</span><span style="color:#bfbab0cc;">, </span><span>|</span><span style="color:#f29718;">b</span><span>| b</span><span style="color:#f29668;">.</span><span style="color:#f07178;">iter</span><span>(|| </span><span style="color:#bfbab0cc;">-&gt; </span><span style="color:#ff7733;">u64 </span><span>{
</span><span>            </span><span style="color:#ff7733;">let</span><span> value </span><span style="color:#f29668;">= </span><span style="color:#f07178;">value_arg</span><span>(</span><span style="color:#f29718;">1_</span><span style="color:#ff7733;">u64</span><span>)</span><span style="color:#bfbab0cc;">;
</span><span>            value </span><span style="color:#f29668;">+ </span><span style="color:#f29718;">1
</span><span>        }))</span><span style="color:#bfbab0cc;">;
</span><span>        c</span><span style="color:#f29668;">.</span><span style="color:#f07178;">bench_function</span><span>(</span><span style="color:#c2d94c;">&quot;optional Some(1_u64)&quot;</span><span style="color:#bfbab0cc;">, </span><span>|</span><span style="color:#f29718;">b</span><span>| b</span><span style="color:#f29668;">.</span><span style="color:#f07178;">iter</span><span>(|| </span><span style="color:#bfbab0cc;">-&gt; </span><span style="color:#ff7733;">u64 </span><span>{
</span><span>            </span><span style="color:#ff7733;">let</span><span> value </span><span style="color:#f29668;">= </span><span style="color:#f07178;">optional_arg</span><span>(</span><span style="font-style:italic;color:#39bae6;">Some</span><span>(</span><span style="color:#f29718;">1_</span><span style="color:#ff7733;">u64</span><span>))</span><span style="color:#bfbab0cc;">;
</span><span>            value </span><span style="color:#f29668;">+ </span><span style="color:#f29718;">1
</span><span>        }))</span><span style="color:#bfbab0cc;">;
</span><span>        c</span><span style="color:#f29668;">.</span><span style="color:#f07178;">bench_function</span><span>(</span><span style="color:#c2d94c;">&quot;optional_into 1_u64&quot;</span><span style="color:#bfbab0cc;">, </span><span>|</span><span style="color:#f29718;">b</span><span>| b</span><span style="color:#f29668;">.</span><span style="color:#f07178;">iter</span><span>(|| </span><span style="color:#bfbab0cc;">-&gt; </span><span style="color:#ff7733;">u64 </span><span>{
</span><span>            </span><span style="color:#ff7733;">let</span><span> value </span><span style="color:#f29668;">= </span><span style="color:#f07178;">optional_arg_with_into</span><span>(</span><span style="color:#f29718;">1_</span><span style="color:#ff7733;">u64</span><span>)</span><span style="color:#bfbab0cc;">;
</span><span>            value </span><span style="color:#f29668;">+ </span><span style="color:#f29718;">1
</span><span>        }))</span><span style="color:#bfbab0cc;">;
</span><span>        c</span><span style="color:#f29668;">.</span><span style="color:#f07178;">bench_function</span><span>(</span><span style="color:#c2d94c;">&quot;optional_into Some(1_u64)&quot;</span><span style="color:#bfbab0cc;">, </span><span>|</span><span style="color:#f29718;">b</span><span>| b</span><span style="color:#f29668;">.</span><span style="color:#f07178;">iter</span><span>(|| </span><span style="color:#bfbab0cc;">-&gt; </span><span style="color:#ff7733;">u64 </span><span>{
</span><span>            </span><span style="color:#ff7733;">let</span><span> value</span><span style="color:#bfbab0cc;">: </span><span style="color:#ff7733;">u64 </span><span style="color:#f29668;">= </span><span style="color:#f07178;">optional_arg_with_into</span><span>(</span><span style="font-style:italic;color:#39bae6;">Some</span><span>(</span><span style="color:#f29718;">1_</span><span style="color:#ff7733;">u64</span><span>))</span><span style="color:#bfbab0cc;">;
</span><span>            value </span><span style="color:#f29668;">+ </span><span style="color:#f29718;">1
</span><span>        }))</span><span style="color:#bfbab0cc;">;
</span><span>        c</span><span style="color:#f29668;">.</span><span style="color:#f07178;">bench_function</span><span>(</span><span style="color:#c2d94c;">&quot;optional_into (u64) None&quot;</span><span style="color:#bfbab0cc;">, </span><span>|</span><span style="color:#f29718;">b</span><span>| b</span><span style="color:#f29668;">.</span><span style="color:#f07178;">iter</span><span>(|| </span><span style="color:#bfbab0cc;">-&gt; </span><span style="color:#ff7733;">u64 </span><span>{
</span><span>            </span><span style="color:#ff7733;">let</span><span> value</span><span style="color:#bfbab0cc;">: </span><span style="color:#ff7733;">u64 </span><span style="color:#f29668;">= </span><span style="color:#f07178;">optional_arg_with_into</span><span>(</span><span style="font-style:italic;color:#39bae6;">None</span><span>)</span><span style="color:#bfbab0cc;">;
</span><span>            value </span><span style="color:#f29668;">+ </span><span style="color:#f29718;">1
</span><span>        }))</span><span style="color:#bfbab0cc;">;
</span><span>        c</span><span style="color:#f29668;">.</span><span style="color:#f07178;">bench_function</span><span>(</span><span style="color:#c2d94c;">&quot;optional_into 1_u8.into()&quot;</span><span style="color:#bfbab0cc;">, </span><span>|</span><span style="color:#f29718;">b</span><span>| b</span><span style="color:#f29668;">.</span><span style="color:#f07178;">iter</span><span>(|| </span><span style="color:#bfbab0cc;">-&gt; </span><span style="color:#ff7733;">u64 </span><span>{
</span><span>            </span><span style="color:#ff7733;">let</span><span> value</span><span style="color:#bfbab0cc;">: </span><span style="color:#ff7733;">u64 </span><span style="color:#f29668;">= </span><span style="color:#f07178;">optional_arg_with_into</span><span>(</span><span style="color:#ff7733;">u64</span><span style="color:#f29668;">::</span><span>from(</span><span style="color:#f29718;">1_</span><span style="color:#ff7733;">u8</span><span>))</span><span style="color:#bfbab0cc;">;
</span><span>            value </span><span style="color:#f29668;">+ </span><span style="color:#f29718;">1
</span><span>        }))</span><span style="color:#bfbab0cc;">;
</span><span>        c</span><span style="color:#f29668;">.</span><span style="color:#f07178;">bench_function</span><span>(</span><span style="color:#c2d94c;">&quot;optional_into Vec&lt;u64&gt;::new()&quot;</span><span style="color:#bfbab0cc;">, </span><span>|</span><span style="color:#f29718;">b</span><span>| b</span><span style="color:#f29668;">.</span><span style="color:#f07178;">iter</span><span>(|| </span><span style="color:#bfbab0cc;">-&gt; </span><span style="font-style:italic;color:#39bae6;">Vec</span><span>&lt;</span><span style="color:#ff7733;">u64</span><span>&gt; {
</span><span>            </span><span style="color:#ff7733;">let</span><span> value</span><span style="color:#bfbab0cc;">: </span><span style="font-style:italic;color:#39bae6;">Vec</span><span>&lt;</span><span style="color:#ff7733;">u64</span><span>&gt; </span><span style="color:#f29668;">= </span><span style="color:#f07178;">optional_arg_with_into</span><span>(</span><span style="font-style:italic;color:#39bae6;">Vec</span><span style="color:#bfbab0cc;">::</span><span>&lt;</span><span style="color:#ff7733;">u64</span><span>&gt;</span><span style="color:#f29668;">::</span><span>new())</span><span style="color:#bfbab0cc;">;
</span><span>            value
</span><span>        }))</span><span style="color:#bfbab0cc;">;
</span><span>        c</span><span style="color:#f29668;">.</span><span style="color:#f07178;">bench_function</span><span>(</span><span style="color:#c2d94c;">&quot;optional_into (Vec&lt;u64&gt;) None&quot;</span><span style="color:#bfbab0cc;">, </span><span>|</span><span style="color:#f29718;">b</span><span>| b</span><span style="color:#f29668;">.</span><span style="color:#f07178;">iter</span><span>(|| </span><span style="color:#bfbab0cc;">-&gt; </span><span style="font-style:italic;color:#39bae6;">Vec</span><span>&lt;</span><span style="color:#ff7733;">u64</span><span>&gt; {
</span><span>            </span><span style="color:#ff7733;">let</span><span> value</span><span style="color:#bfbab0cc;">: </span><span style="font-style:italic;color:#39bae6;">Vec</span><span>&lt;</span><span style="color:#ff7733;">u64</span><span>&gt; </span><span style="color:#f29668;">= </span><span style="color:#f07178;">optional_arg_with_into</span><span>(</span><span style="font-style:italic;color:#39bae6;">None</span><span style="color:#bfbab0cc;">::</span><span>&lt;</span><span style="font-style:italic;color:#39bae6;">Vec</span><span>&lt;</span><span style="color:#ff7733;">u64</span><span>&gt;&gt;)</span><span style="color:#bfbab0cc;">;
</span><span>            value
</span><span>        }))</span><span style="color:#bfbab0cc;">;
</span><span>    }
</span><span>}
</span></code></pre>
<p>–≠—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, –ø–æ—ç—Ç–æ–º—É —è –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–µ —Å–æ–≤—Å–µ–º —É–≤–µ—Ä–µ–Ω, —á—Ç–æ –µ–≥–æ –∫–∞–∫-—Ç–æ –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç. –ö–æ–º–ø—å—é—Ç–µ—Ä—ã –∫–æ–≤–∞—Ä–Ω—ã. </p>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>value 1_u64             time:   [264.11 ps 264.50 ps 264.97 ps]                        
</span><span>Found 15 outliers among 100 measurements (15.00%)
</span><span>  1 (1.00%) low mild
</span><span>  5 (5.00%) high mild
</span><span>  9 (9.00%) high severe
</span><span>
</span><span>optional Some(1_u64)    time:   [263.41 ps 263.86 ps 264.44 ps]                                 
</span><span>Found 18 outliers among 100 measurements (18.00%)
</span><span>  3 (3.00%) low mild
</span><span>  4 (4.00%) high mild
</span><span>  11 (11.00%) high severe
</span><span>
</span><span>optional_into 1_u64     time:   [258.67 ps 259.43 ps 260.37 ps]                                
</span><span>Found 7 outliers among 100 measurements (7.00%)
</span><span>  3 (3.00%) high mild
</span><span>  4 (4.00%) high severe
</span><span>
</span><span>optional_into Some(1_u64)                                                                            
</span><span>                        time:   [252.95 ps 253.41 ps 253.94 ps]
</span><span>Found 6 outliers among 100 measurements (6.00%)
</span><span>  2 (2.00%) high mild
</span><span>  4 (4.00%) high severe
</span><span>
</span><span>optional_into (u64) None                                                                            
</span><span>                        time:   [256.31 ps 256.89 ps 257.70 ps]
</span><span>Found 12 outliers among 100 measurements (12.00%)
</span><span>  3 (3.00%) high mild
</span><span>  9 (9.00%) high severe
</span><span>
</span><span>optional_into 1_u8.into()                                                                            
</span><span>                        time:   [255.77 ps 256.33 ps 257.04 ps]
</span><span>Found 12 outliers among 100 measurements (12.00%)
</span><span>  1 (1.00%) low mild
</span><span>  7 (7.00%) high mild
</span><span>  4 (4.00%) high severe
</span><span>
</span><span>optional_into Vec&lt;u64&gt;::new()                                                                             
</span><span>                        time:   [853.18 ps 858.14 ps 863.70 ps]
</span><span>Found 4 outliers among 100 measurements (4.00%)
</span><span>  4 (4.00%) high mild
</span><span>
</span><span>optional_into (Vec&lt;u64&gt;) None                                                                             
</span><span>                        time:   [830.59 ps 833.04 ps 835.56 ps]
</span></code></pre>
<h2 id="chto-my-uznali-i-vyvody">–ß—Ç–æ –º—ã —É–∑–Ω–∞–ª–∏ –∏ –≤—ã–≤–æ–¥—ã</h2>
<p>–ú—ã —É–∑–Ω–∞–ª–∏, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ API —Å –ø–æ–º–æ—â—å—é Rust. –í–æ –≤—Ä–µ–º—è –Ω–∞—à–µ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –º—ã –æ—Ç–º–µ—Ç–∏–ª–∏, —á—Ç–æ –≤—ã–±–æ—Ä —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±—ä—è–≤–ª–µ–Ω–∏—è –Ω–∞—à–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏/–∏–ª–∏ –≤–∫–ª—é—á–µ–Ω–∏–µ –±–æ–ª–µ–µ –≥–∏–±–∫–æ–≥–æ API –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–∏—Ö –∑–∞—Ç—Ä–∞—Ç.</p>
<p>–ï—Å–ª–∏ –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –≤–∫–ª—é—á–µ–Ω–∏–∏ –≥–∏–±–∫–∏—Ö API-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –≤ Rust, —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∏–∑—É—á–∏—Ç—å –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ. –Ø —Ç–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∏–∑—É—á–∏—Ç—å —à–∞–±–ª–æ–Ω Builder, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω –æ–±—ã—á–Ω–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Rust.</p>
<p>–°–ø–∞—Å–∏–±–æ –∑–∞ —á—Ç–µ–Ω–∏–µ! –ù–∞–¥–µ—é—Å—å –≤—Å–∫–æ—Ä–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–∞—à –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã–π –∫–æ–¥. üòâ</p>
<blockquote>
<p>P.S. –ï—Å–ª–∏ –≤—ã –∏—â–µ—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å –≤—ã—Å—à–µ–≥–æ —É—Ä–æ–≤–Ω—è, —É–≤–ª–µ—á–µ–Ω—ã —ç—Ç–æ–π —Ç–µ–º–æ–π –∏ –∏–º–µ–µ—Ç–µ –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–º–∏ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, —Å–µ—Ç—è–º–∏ –∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ö–∞–æ—Å–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ. –ú—ã –º–æ–∂–µ–º –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å –≤ –º–æ–µ–π –∫–æ–º–∞–Ω–¥–µ –≤ PingCAP –Ω–∞–¥ —ç–∫–æ—Å–∏—Å—Ç–µ–º–æ–π —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –¥–ª—è TiKV –∏ –µ–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. –í –±—É–¥—É—â–µ–º –≤—ã –≤–æ–∑—å–º–µ—Ç–µ –Ω–∞ —Å–µ–±—è –Ω–∞—Å—Ç–∞–≤–Ω–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö —é–Ω–∏–æ—Ä–æ–≤, —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –∏ —á–ª–µ–Ω–æ–≤ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ –≤ —Ü–µ–ª–æ–º. –î—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ —É–¥–∞–ª–µ–Ω–Ω—ã–º, –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞—è –∑–∞—Ä–∞–±–æ—Ç–Ω–∞—è –ø–ª–∞—Ç–∞, –ø–æ–∫—Ä—ã—Ç–∏–µ –ø–æ–µ–∑–¥–æ–∫ –¥–ª—è –≥–æ–≤–æ—Ä—è—â–∏—Ö, –æ—á–µ–Ω—å –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∫ –º–µ–Ω—å—à–∏–Ω—Å—Ç–≤–∞–º (–º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ, —Ä–∞—Å–∞, –ø–æ–ª–æ–≤–∞—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å, –ø–æ–ª –∏ —Ç.–¥.). </p>
</blockquote>










<script src="https://giscus.app/client.js"
    data-repo="dudochkin-victor&#x2F;dudochkin-victor.github.io"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzNzgwNTYx"
    data-category="General"
    data-category-id="DIC_kwDOADmv0c4CAhvj"
    data-mapping="pathname"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async>
</script>



        </div>

        
        
    </main>

    
    <footer>
        <small class="subtext">
            <a href="https://angular-rust.github.io">Dudochkin Victor</a> ¬© 2021
        </small>
    </footer>
    
</body>
<script>
    function highlightNav(heading) {
        let pathname = location.pathname;
        document.querySelectorAll(".toc a").forEach((item) => {
            item.classList.remove("active");
        });
        document.querySelector(".toc a[href$='" + pathname + "#" + heading + "']").classList.add("active");
    }

    let currentHeading = "";
    window.onscroll = function () {
        let h = document.querySelectorAll("h1,h2,h3,h4,h5,h6");
        let elementArr = [];

        h.forEach(item => {
            if (item.id !== "") {
                elementArr[item.id] = item.getBoundingClientRect().top;
            }
        });
        elementArr.sort();
        for (let key in elementArr) {
            if (!elementArr.hasOwnProperty(key)) {
                continue;
            }
            if (elementArr[key] > 0 && elementArr[key] < 300) {
                if (currentHeading !== key) {
                    highlightNav(key);
                    currentHeading = key;
                }
                break;
            }
        }
    }
</script>

</html>
