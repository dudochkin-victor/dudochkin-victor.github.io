+++
title = "Настройка валидатора"
sort_by = "weight"
updated = 2022-10-02T15:00:00Z
+++

Добро пожаловать в официальное подробное руководство Edgeware по проверке. Мы рады, что вы заинтересованы в проверке Edgeware, и мы сделаем все возможное, чтобы предоставить подробную документацию по описанному ниже процессу. Как всегда, обращайтесь в [Discord](https://discord.gg/CJRfb3) или [Telegram](https://t.me/heyedgeware), если у вас есть вопросы о проекте.

Этот документ содержит всю информацию, необходимую для начала проверки в Edgeware с использованием **интерфейса командной строки**. Мы начнем с настройки своего узла и перейдем к управлению ключами и мониторингу. Для начала мы будем использовать следующую терминологию ключей для руководства:

- _**stash**_ - пара ключей тайника, где должна находиться большая часть ваших средств. При необходимости его можно хранить в холодильнике.
- _**controller**_ — контроллер — это пара ключей, которая будет управлять настройками вашего валидатора. Он должен иметь меньший баланс, например. 10-100 ЭДГ
- _**session**_ — 4 пары ключей сеанса — это горячие клавиши, которые хранятся на вашем узле валидатора. Им не нужны балансы.

## Требования

1. Вам понадобится 6 пар ключей: «тайник» (ed25519 или sr25519), «контроллер» (ed25519 или sr25519) и 4 «сеанса» (3 ed25519 и 1 sr25519). Вы можете сгенерировать их с помощью утилиты `subkey`. В примерах мы будем использовать производные ключи. Если вы не используете производные ключи, просто введите начальное число/мнемонику, необходимые для подписи этих учетных записей.
2. Ключи ауры \(ed25519\)
3. Дедушкины ключи \(ed25519\)
4. Ключи ImOnline \(ed25519\)
5. Ключи обнаружения полномочий \(sr25519\)
6. Вам потребуется как минимум экзистенциальный баланс \(1 000 000 000 000 000 единиц токенов, т.е. 0,0001 EDG\) как на счете «тайник», так и на счете «контроллер», а также баланс, необходимый для отправки транзакций с этих счетов.
7. Вам понадобится активный, полностью синхронизированный узел Edgeware, работающий с флагом `--validator`, который установил ключи сеанса до или после завершения процесса подключения.

## Предпосылки

- Сначала следуйте инструкциям в [README.md](https://github.com/hicommonwealth/edgeware-node/blob/master/README.md) по установке и запуску `edgeware-node`.

- Загрузите из исходного кода или из реестра `npm` `edgeware-cli`, расположенный [здесь](https://github.com/hicommonwealth/edgeware-cli/).
  
  Примечание. `edgeware-cli` имеет несколько зависимостей [просмотреть здесь](https://www.npmjs.com/package/edgeware-cli)

- Также установите `subkey`, если вам нужно сгенерировать новые пары ключей:
  
  Cargo install --force --git [https://github.com/paritytech/substrate](https://github.com/paritytech/substrate) подраздел

С этого момента мы предполагаем, что вы знакомы с использованием `subkey`, если это не так, вы можете прочитать о командах `subkey` [здесь](https://github.com/paritytech/substrate/blob /master/bin/utils/subkey/README.adoc).

## Онбординг

1. Сначала создайте пары ключей _**stash**_ и _**controller**_, используя `subkey`. Вы также можете **опционально** \**\*создать 4 сеансовых ключа. Создайте пары ключей ED25519, используя флаг `-e` с подразделом.

2. Затем вам нужно будет связать пару ключей _**stash**_ с парой ключей _**controller**_. Используя CLI и локальный узел, вы запустите:

3. ```
   edge -s <STASH_SEED> staking bond <CONTROLLER_B58_ADDRESS> <AMOUNT> <REWARD_DESTINATION>
   ```

4. Семя _**stash**_ должно быть мнемоническим кодом + путем вывода для вашей пары ключей _**stash**_.

5. Адрес _**контроллера**_ должен быть открытым ключом в кодировке Base58 \(начинается с 5\)

6. Баланс _**сумма**_ должен быть целым числом в единицах EDG.

7. _**место назначения вознаграждения**_ — это место, куда будут направляться вознаграждения; варианты: `тайник`, `контроллер` и `стейкинг` (где ставка добавляет вознаграждение к сумме ставки\)

8. Затем вам нужно будет установить настройки валидатора из вашей учетной записи _**controller**_. Используя CLI и локальный узел, вы запустите:
   
   ```
   edge -s <CONTROLLER_SEED> staking validate <COMMISSION_PERCENTAGE>
   ```

9. Семя _**controller**_ должно быть мнемоническим кодом + путем вывода для вашей пары ключей _**controller**_

10. _**Порог отмены ставок**_ – это количество раз, когда ваш узел отключался от сети, прежде чем он отключился.

11. _**процент комиссии**_ – это процент вознаграждения, который вы

12. Затем вам нужно будет установить ключи _**session**_ из пары ключей _**controller**_. Используя CLI и локальный узел, вы запустите:
    
    ```
    edge -s <CONTROLLER_SEED> session setKeys <OUTPUT_FROM_ROTATE_KEYS> 0x
    ```

13. Семя _**controller**_ должно быть мнемоническим кодом + путем вывода для вашей пары ключей _**controller**_

14. Открытые ключи _**session**_ должны быть объединены из выходных данных команды rotate keys rpc.

### Ниже приведены примеры всех команд:

Далее мы загрузили и скомпилировали `edgeware-cli` из исходного кода, чтобы получить двоичный файл `/bin/edge`. Вы можете использовать `tsc`, если вы компилируете из исходников.

```
edge -s "axis service this custom because top clap sock weekend tenant vehicle merge" staking bond 10 stash // bond 10 EDG (10 * 10^18 currency units)

edge -s "axis service this custom because top clap sock weekend tenant vehicle merge" session setKeys 0fea2a18acbd19e4a21c3ae29ecefee61d32d46dc4b9a9c5ccecbbbdff7b0a7e8e55bd3035d18f40d8dd1b5d940c47066ddb6f37ec7261d69121e8353d612d1410f7b7f954b3225b148c5de650e0bc3c941ae65e1557c3805c3b0df37285c3892cc2f99d97254ffdf1640c29dff2c6272dbf4dc8dedb46e43ba0bd12ab269b3c 0x // set session keys to the 4 concatentated keys submitted

edge -s "axis service this custom because top clap sock weekend tenant vehicle merge" staking validate 10 // set validator preferences to 10% commission
```

## Проверка

Тестовая сеть v099 требует, чтобы валидаторы управляли 4 ключами проверки для модулей Aura, Grandpa, ImOnline и AuthorityDiscovery.

1. Ключи ауры \(ed25519\)
2. Дедушкины ключи \(ed25519\)
3. Ключи ImOnline \(ed25519\)
4. Ключи обнаружения полномочий \(sr25519\)

Теперь во время запуска полной ноды для синхронизации или после нее вы можете приступить к настройке сеансовых ключей для ноды. Команда для вставки ключей и поворота ключей такая же, как и раньше. Чтобы чередовать новые ключи сеанса, выполните следующее, пока работает ваш узел:

```
curl -H 'Content-Type: application/json' --data '{ "jsonrpc":"2.0", "method":"author_rotateKeys", "id":1 }' 127.0.0.1:9933
```

Чтобы вставить существующие ключи сеанса, вы можете запустить для каждого ключа следующую команду во время работы вашего узла:

```
curl -H 'Content-Type: application/json' --data '{ "jsonrpc":"2.0", "method":"author_insertKey", "params":["KEY_TYPE", "SEED", "PUBKEY_HEX"],"id":1 }' localhost:9933
```

Четыре ключевых типа, которые вы будете вводить:

- `аура` для ключей ауры
- `гран` для дедушкиных ключей
- `imon` для ключей ImOnline
- `audi` для ключей AuthorityDiscovery

После выполнения этих команд `curl` вы должны получить в качестве вывода из `stdout` открытые ключи, которые вы предоставили (или не предоставили) в строке JSON. Это также означает, что процесс был успешным! Теперь вы должны увидеть себя в списке новых/ожидающих проверки валидаторов, которые вступят в силу в будущих сеансах. В следующей эре \(до 1 часа\), если есть свободный слот, ваша нода станет активным валидатором. 
Chetyre klyuchevykh tipa, kotoryye vy budete vvodit':


