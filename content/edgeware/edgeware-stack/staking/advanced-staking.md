+++
title = "Дополнительно: Ставка"
sort_by = "weight"
updated = 2022-10-02T15:00:00Z
+++

## Стейкинг

_Это руководство отредактировано из Polkadot Wiki с благодарностью_

Edgeware использует NPoS (Nominated Proof-of-Stake) в качестве механизма выбора набора валидаторов. Он разработан с ролями **валидаторов** и **номинаторов**, чтобы максимизировать безопасность цепи. Субъекты, заинтересованные в поддержании сети, могут запустить узел валидатора. На момент создания Edgeware будет иметь ограниченное количество слотов, доступных для этих валидаторов, но со временем это число вырастет до более чем тысячи.

Система поощряет владельцев EDG участвовать в качестве номинаторов. Номинаторы могут поддерживать до 16 валидаторов в качестве доверенных кандидатов в валидаторы.

Валидаторы берут на себя роль создания новых блоков, проверки блоков и гарантии окончательности. Номинаторы могут поддержать выбранных валидаторов своей долей.

Система ставок выплачивает вознаграждения всем валидаторам поровну. Распределение вознаграждений пропорционально всем стейкерам после вычета платежа валидатора. Таким образом, сеть стимулирует назначение валидаторов с более низкими ставками для создания набора валидаторов с равными ставками.

### Как работает стейкинг в Edgeware?

#### 1. Определение вашей роли

В стекинге вы можете быть либо [номинатором, либо валидатором] (https://wiki.polkadot.network/docs/en/learn-staking#validators-and-nominators).

Как номинатор, вы можете номинировать одного или нескольких (до 16) кандидатов-валидаторов, которым вы доверяете, чтобы помочь вам заработать вознаграждение в EDG. Вы можете взглянуть на [руководство по номинатору](https://wiki.polkadot.network/docs/en/maintain-nominator), чтобы понять, что вам необходимо сделать при запуске основной сети.

Узел валидатора должен реагировать круглосуточно и без выходных, своевременно выполнять свои ожидаемые обязанности и избегать любого поведения с косой чертой.

#### 2. Срок номинации

Любые потенциальные валидаторы могут указать свое намерение стать кандидатом в валидаторы. Их кандидатуры доводятся до сведения всех номинаторов, а номинатор, в свою очередь, представляет список из любого числа кандидатов, которых он поддерживает. В следующую эпоху (продолжительностью несколько часов) избирается и становится активным определенное количество валидаторов, имеющих наибольшую поддержку EDG. Нет особых требований к держателю EDG, чтобы стать номинатором, хотя мы ожидаем, что каждый номинатор будет тщательно отслеживать эффективность и репутацию валидаторов.

Как только период номинации заканчивается, механизм выборов NPoS принимает номинаторов и связанные с ними голоса в качестве входных данных и выводит набор валидаторов требуемого размера, который максимизирует поддержку доли любого валидатора и делает доли, поддерживающие валидаторов, равномерно распределенными. насколько это возможно. Целями этого избирательного механизма являются максимальная безопасность сети и справедливое представительство номинантов. Если вы хотите узнать больше о том, как работает NPoS (например, выборы, сложность времени выполнения и т. д.), прочитайте [здесь](http://research.web3.foundation/en/latest/polkadot/NPoS/).

#### 

3. Распределение вознаграждений за стекинг

Чтобы объяснить, как выплачиваются вознаграждения валидаторам и номинаторам, нам нужно рассмотреть **пулы валидаторов**, где пул валидаторов состоит из избранного валидатора вместе с поддерживающими его номинаторами. (Примечание: если номинатор `n` с долей `s` поддерживает несколько избранных валидаторов, скажем, `k`, механизм выборов NPoS разделит свои доли на части `s_1`, `s_2`, …, `s_k`, так что он поддерживает валидатора `i` со ставкой `s_i`. В этом случае номинатор `n` будет вознагражден так же, как если бы было `k` номинаторов в разных пулах, каждый из которых поддерживает одного валидатора `i` со ставкой `s_i` ). Для каждого пула валидаторов мы храним список номинаторов с соответствующими ставками.

Общее правило для вознаграждений между пулами валидаторов заключается в том, что два пула валидаторов получают **одинаковую сумму EDG** за одинаковую работу, т. е. они НЕ выплачиваются пропорционально ставкам в каждом пуле. В рамках пула валидаторов (настраиваемая) часть вознаграждения идет на оплату комиссионных сборов валидатора, а оставшаяся часть выплачивается **пропорционально** (то есть пропорционально ставке) номинаторам и валидатору. В частности, обратите внимание, что валидатор получает вознаграждение дважды: один раз в виде комиссионных за валидацию и один раз за то, что номинирует себя со ставкой.

Чтобы оценить уровень инфляции и сколько EDG вы можете получать каждый месяц в качестве номинатора или валидатора, вы можете использовать эту [таблицу Excel](https://docs.google.com/spreadsheets/d/1-9Hc3kZ23EhZC3X6feRUKSTv6gj4xR7cvUbJD2zUEZk/edit?usp =sharing) в качестве эталона и поэкспериментируйте с ним, изменив некоторые параметры (например, пулы валидаторов, общее предложение, комиссионные сборы и т. д.), чтобы получить более точную оценку. Несмотря на то, что он может быть не совсем точным, поскольку участие в ставках меняется динамически, он хорошо работает в качестве индикатора.

#### 4. Механизм вознаграждения

Мы выделяем две особенности этой схемы оплаты. Во-первых, поскольку пулы валидаторов оплачиваются одинаково, пулы с меньшей долей будут платить больше номинаторам за EDG, чем пулы с большей долей. Таким образом, мы даем номинаторам экономический стимул для постепенного смещения своих предпочтений в пользу валидаторов с более низкими ставками, которые получают достаточную репутацию. Причина этого в том, что мы хотим, чтобы доля между пулами валидаторов была как можно более равномерно распределена, чтобы избежать концентрации власти среди нескольких валидаторов. В долгосрочной перспективе мы ожидаем, что все пулы валидаторов будут иметь одинаковые уровни ставки, причем ставка будет выше для валидаторов с более высокой репутацией (это означает, что номинатор, который готов рискнуть больше, поддерживая валидатора с низкой репутацией, получит больше). .

Следующий пример должен прояснить вышеизложенное. Для простоты имеем следующие предположения:

- У этих валидаторов нет собственного стейка.
- Они НЕ взимают комиссию
- Сумма вознаграждения составляет 100 токенов EDG.
- Минимальное количество EDG для валидатора 350

|               |                        |                             |         |
| ------------- | ---------------------- | --------------------------- | ------- |
|               | **A - Validator Pool** |                             |         |
| Nominator (4) | Stake (600)            | Fraction of the Total Stake | Rewards |
| Jin           | 100                    | 0.167                       | 16.7    |
| **Sam**       | 50                     | 0.083                       | 8.3     |
| Anson         | 250                    | 0.417                       | 41.7    |
| Bobby         | 200                    | 0.333                       | 33.3    |

|               |                        |                             |         |
| ------------- | ---------------------- | --------------------------- | ------- |
|               | **B - Validator Pool** |                             |         |
| Nominator (4) | Stake (400)            | Fraction of the Total Stake | Rewards |
| Alice         | 100                    | 0.25                        | 25      |
| Peter         | 100                    | 0.25                        | 25      |
| John          | 150                    | 0.375                       | 37.5    |
| **Kitty**     | 50                     | 0.125                       | 12.5    |

_Оба пула валидаторов A и B имеют 4 номинатора с общим стейком 600 и 400 соответственно._

Основываясь на приведенном выше распределении вознаграждений, номинаторы в пуле валидаторов B получают больше вознаграждений за EDG, чем в пуле A, потому что у пула A больше общая доля. Сэм поставил 50 EDG в пуле A, но взамен он получил только 8,3, тогда как Китти получила 12,5 при той же сумме ставки.

Мы также отмечаем, что когда сеть урезает слот валидатора из-за неправильного поведения (например, оффлайн валидатора, двусмысленности и т. д.), сокращенная сумма представляет собой фиксированный процент (а НЕ фиксированное количество EDG), что означает, что пулы валидаторов с большей долей получают урезал больше EDG. Опять же, это делается для того, чтобы предоставить номинаторам экономический стимул изменить свои предпочтения и поддержать менее популярных валидаторов, которых они считают заслуживающими доверия.

Второй момент, который следует отметить, заключается в том, что каждый кандидат в валидаторы может указать желаемую комиссию (в процентах от вознаграждения) для покрытия операционных расходов. Поскольку пулы валидаторов оплачиваются одинаково, пулы с более низкой комиссией платят номинаторам больше, чем пулы с более высокой комиссией. Таким образом, каждый валидатор может выбирать между увеличением своих сборов, чтобы заработать больше EDG, или снижением своих сборов, чтобы привлечь больше номинаторов и повысить свои шансы на избрание. Мы позволим рынку регулировать себя в этом отношении. В долгосрочной перспективе мы ожидаем, что все валидаторы должны быть экономически эффективными, чтобы оставаться конкурентоспособными, и что валидаторы с более высокой репутацией смогут взимать немного более высокие комиссионные (что справедливо).

### Счета

Есть две разные учетные записи для управления вашими средствами: «Шкатулка» и «Контроллер».

![staking](https://wiki.polkadot.network/docs/assets/NPoS/staking-keys\_stash\_controller.png)

- **Шкатулка:** Эта учетная запись содержит средства, привязанные к стейкингу, но делегирует некоторые функции контролеру. В результате вы можете активно участвовать с ключом Stash, хранящимся в холодном кошельке, то есть он все время остается в автономном режиме. Вы также можете назначить учетную запись-посредника для голосования в предложениях [управления](https://wiki.polkadot.network/docs/en/learn-governance).
- **Контролер** Эта учетная запись действует от имени учетной записи Stash, сигнализируя о решениях о назначении и подтверждении. Он устанавливает настройки, такие как счет выплат и комиссия. Если вы являетесь валидатором, он также устанавливает ваши [ключи сеанса] (https://wiki.polkadot.network/docs/en/learn-keys#session-keys). Ему нужно только достаточно средств, чтобы оплатить комиссию за транзакцию.

Мы разработали эту иерархию отдельных типов ключей, чтобы операторы валидаторов и номинаторы могли защитить себя намного лучше, чем в системах только с одним ключом. Как правило, вы теряете безопасность каждый раз, когда используете один ключ для нескольких ролей, или даже если вы используете ключи, связанные производным путем. Вы никогда не должны использовать какой-либо ключ учетной записи для «горячего» сеансового ключа, в частности.

Ключи учетной записи Controller и Stash могут быть либо sr25519, либо ed25519.

### Валидаторы и номинаторы

Поскольку количество слотов для валидаторов будет ограничено, большинство из тех, кто хочет поставить свои DOT и внести вклад в экономическую безопасность сети, будут номинаторами. Валидаторы делают большую часть тяжелой работы: они создают новых кандидатов на блоки, голосуют и приходят к консенсусу в GRANDPA, проверяют STF парачейнов и, возможно, некоторые другие обязанности, связанные с доступностью данных и XCMP.

Номинаторам, с другой стороны, не нужно ничего делать после того, как они связали свой EDG. Опыт номинатора аналогичен «установил и забыл», в то время как валидатор будет активно обслуживать сеть, выполняя критические операции. По этой причине валидатор имеет определенные привилегии в отношении выплат механизма ставок и сможет объявить о своем собственном распределении до того, как доля будет разделена между номинаторами.

![staking](https://wiki.polkadot.network/docs/assets/NPoS/article-2.png)

### Слэшинг

Слэшинг произойдет, если валидатор неправильно себя ведет (например, выходит из сети, атакует сеть или запускает модифицированное программное обеспечение) в сети. Они и их номинаторы будут урезаны, потеряв процент от их связанных/заложенных EDG.

Пулы валидаторов с большей общей долей, которые их поддерживают, будут сокращены более жестко, чем менее популярные, поэтому мы рекомендуем номинаторам переносить свои номинации на менее популярных валидаторов, чтобы уменьшить возможные потери.

На основе последней кодовой базы Edgeware были реализованы следующие условия сокращения:

#### Не отвечает

Для каждого сеанса валидаторы будут отправлять сообщение «Я в сети», чтобы указать, что они в сети. Если валидатор не создает блоков в течение эпохи и не может отправить пульс, он будет считаться не отвечающим. В зависимости от повторяющихся нарушений и количества других валидаторов, которые не отвечали или не были в сети, произойдет сокращение.

Вот формула для расчета:

```
Let x = offenders, n = total no. validators

min((3 * (k - (n / 10 + 1))) / n, 1) * 0.07
```

Обратите внимание, что если менее 10% всех валидаторов находятся в автономном режиме, штраф не применяется.

Валидаторы должны иметь хорошо спроектированную сетевую инфраструктуру, чтобы убедиться, что узел работает, чтобы снизить риск взлома. Желательна установка с высокой доступностью, предпочтительно с резервными узлами, которые включаются **только после того, как исходный узел будет проверено в автономном режиме** (чтобы избежать двойной подписи и слэша для двусмысленности — см. ниже), вместе с прокси-узлами, чтобы избежать DDoS-атак. когда раскрывается IP-адрес вашего узла валидатора. Полное руководство по настройке безопасного валидатора находится в разработке, черновик доступен [здесь] (https://wiki.polkadot.network/docs/en/maintain-guides-secure-validator).

**ДЕДУШКА Неопределенность:**
Валидатор подписывает два или более голосов в одном раунде в разных цепочках.

Штраф за двусмысленность ДЕДУШКИ рассчитывается следующим образом:

```
Let x = offenders, n = total no. validators

Min( (3 * x / n )^2, 1)
```

Валидаторы могут запускать свои узлы на нескольких машинах, чтобы убедиться, что они все еще могут выполнять работу по проверке в случае, если один из их узлов выйдет из строя. Следует отметить, что если у них нет хорошей координации для управления подписывающими машинами, возможна двусмысленность.

> Примечание: если на валидатора будет сообщено за любое из нарушений, он будет удален из набора валидаторов, и ему не будут платить, пока его выгоняют.

Если вы хотите узнать больше о сокращении, посетите нашу [страницу исследований](https://research.web3.foundation/en/latest/polkadot/slashing/amounts.html).

### Распределение наград

Награды записываются за сеанс и выплачиваются за эпоху.

#### Пример

```
    PER_ERA * BLOCK_TIME = **Reward Distribution Time**

    3600 * 6 seconds = 21,600 s = 6 hours

    ***These parameters can be changed by proposing a referendum***
```

Валидаторы могут создавать часть вознаграждения, которая не делится с номинаторами. Это сокращение представляет собой процент вознаграждения за блок, а не абсолютное значение. После того, как значение вычитается, оставшаяся часть основана на их сумме ставок и делится между валидатором и всеми номинаторами, которые проголосовали за этого валидатора.

Например, предположим, что вознаграждение за блок для валидатора составляет 10 EDG. Валидатор может указать `validator_payment = 50%`, и в этом случае валидатор получит 5 EDG. Затем оставшиеся 5 EDG будут разделены между валидатором и их номинаторами в зависимости от доли доли, которую имеет каждый номинатор. Обратите внимание, что валидаторы могут выставить свою собственную ставку, и для этого расчета их ставка действует так же, как если бы они были другим номинатором.

Награды могут быть направлены на ту же учетную запись (контроллер) или на счет тайника (и либо увеличивая сумму ставки, либо не увеличивая сумму ставки). Также можно пополнить/снять некоторые облигационные EDG без необходимости отменять все ставки.

## Часто задаваемые вопросы

### Зачем делать ставки?

- 10% инфляции в год при запуске сети
- 50% целевых активных ставок
- \~20% годовой доход

### Почему бы не сделать ставку?

- Токены будут заблокированы на 28 часов после развязки. (См. страницу параметров для получения последних обновленных номеров)
- Токены могут быть урезаны в качестве наказания, если валидатор не работает должным образом.

### Сколько валидаторов будет у Edgeware?

План состоит в том, чтобы начать с 60 открытых позиций валидатора и постепенно открывать больше. Верхний предел количества валидаторов еще не определен.

### Ресурсы

- [Как Nominated Proof of Stake будет работать в Polkadot](https://medium.com/web3foundation/how-nominated-proof-of-stake-will-work-in-polkadot-377d70c6bd43) - Сообщение в блоге исследователя Web3 Foundation Альфонсо Севаллос освещает NPoS в Polkadot.
- [Настройка безопасного валидатора](https://wiki.polkadot.network/docs/en/maintain-guides-secure-validator)
