<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Проверка снапшотов | Dudochkin Victor </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="google-site-verification" content="Kepqb6k6uptlwngnHbBVJmqQtwNW8zfHyQBbTXLYAgA" />
    <meta name="yandex-verification" content="8e8bc73c2566b473" />
    <style>
    :root {
        /* Primary theme color */
        /* --primary-color: #121A26; */
        --primary-color: #0f1419;
        /* Primary theme text color */
        /* --primary-text-color: #121A26; */
        --primary-text-color: #0f1419;
        /* Primary theme link color */
        --primary-link-color: #053961;
        /* Secondary color: the background body color */
        --secondary-color: #F0F0F0;
        --secondary-text-color: #1C2834;
        /* Highlight text color of table of content */
        --toc-highlight-text-color: #053961;
    }
</style>
    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-47MMPLLY44"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-47MMPLLY44');
    </script>
    

    
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript" >
        (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
        (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
    
        ym('87064264', "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true
        });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/87064264" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
    
    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/mdl.min.css">
    <link rel="stylesheet" href="https://dudochkin-victor.github.io/style.css">
    
    
</head>

<body>
    
<header class="box-shadow">
    

<a href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;">
    <div class="logo">
        <img src="https://dudochkin-victor.github.io/ferris.png" alt="logo">
        Dudochkin Victor
    </div>
</a>

<nav>
    <!-- 
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;showcases&#x2F;">Showcases</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;changelog&#x2F;">Changelog</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;about&#x2F;">About</a>
     -->

    
        
        <a class="nav-item subtitle-text" href="&#x2F;solana&#x2F;">Solana</a>
        
        <a class="nav-item subtitle-text" href="&#x2F;edgeware&#x2F;">Edgeware</a>
        
        <a class="nav-item subtitle-text" href="&#x2F;blog&#x2F;">Блог</a>
        
        <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;github.com&#x2F;dudochkin-victor">Github</a>
        
    
</nav>

</header>

 
    <main>
        
        
        
        
        
        <div class="toc">
            <div class="toc-sticky">
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/implemented-proposals/snapshot-verification/#problema">Проблема</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/implemented-proposals/snapshot-verification/#reshenie">Решение</a>
                </div>
                
                
            </div>
        </div>
        
        

        <div class="content text">
            
<h1>Проверка снапшотов</h1>

<h2 id="problema">Проблема</h2>
<p>Когда валидатор загружается из моментального снимка, ему нужен способ быстро проверить соответствие набора учетных записей тому, что видит остальная часть сети. потенциал
Злоумышленник может дать валидатору неверное состояние, а затем попытаться убедить его принять транзакцию, которая в противном случае была бы отклонена.</p>
<h2 id="reshenie">Решение</h2>
<p>В настоящее время хэш банка получается путем хеширования дельта-состояния счетов в слоте, который затем объединяется с предыдущим значением хэша банка.
Проблема в том, что список хэшей будет расти на порядок количества слотов, обрабатываемых цепочкой, и станет бременем для обоих.
передать и проверить успешно.</p>
<p>Другим наивным методом может быть создание дерева меркла состояния учетной записи. Недостатком этого является то, что при каждом обновлении учетной записи дерево меркле
должен быть пересчитан из всего состояния учетных записей всех реальных учетных записей в системе.</p>
<p>Для проверки снимка делаем следующее:</p>
<p>В хранилище аккаунтов ненулевых лэмпорт-аккаунтов мы хешируем следующие данные:</p>
<ul>
<li>Владелец счета</li>
<li>Данные аккаунта</li>
<li>Пубключ аккаунта</li>
<li>Баланс лэмпортов на счету</li>
<li>Форк, на котором хранится учетная запись</li>
</ul>
<p>Используйте полученное хеш-значение в качестве входных данных для функции расширения, которая преобразует хэш-значение в значение изображения.
Функция создаст блок данных размером 440 байт, где первые 32 байта — это хеш-значение, а следующие 440–32 байта —
генерируется из Chacha RNG с хешем в качестве семени.</p>
<p>Затем изображения учетных записей объединяются с помощью xor. Предыдущее значение учетной записи будет преобразовано в состояние, и новое значение учетной записи также будет преобразовано в состояние.</p>
<p>Хэш-значения голосования и системной переменной происходят вместе с хэшем результирующего полного значения изображения.</p>
<p>При загрузке валидатора, когда он загружается из моментального снимка, он проверяет хэш-значение с установленными учетными записями. Тогда бы
используйте SPV, чтобы отобразить процент сети, проголосовавшей за указанное значение хеш-функции.</p>
<p>Полученное значение может быть проверено валидатором как результат объединения всех текущих состояний учетной записи вместе.</p>
<p>Снапшот должен быть очищен от учетных записей с нулевыми лампами перед созданием и во время проверки, поскольку учетные записи с нулевыми лампами не влияют на значение хеш-функции, но могут вызвать
банк-валидатор, чтобы прочитать, что учетная запись отсутствует, когда она действительно должна быть.</p>
<p>Атака на состояние xor может повлиять на его значение:</p>
<p>Таким образом, размер изображения 440 байт взят из этой статьи, что позволяет избежать конфликта xor с 0 (или, следовательно, с любым другим заданным битовым шаблоном): [<a href="https://link.springer.com/content/pdf/10.1007%2F3-540-45708-9_19.pdf">https://link.springer.com/content/pdf/10.1007%2F3-540 -45708-9_19.pdf</a>]</p>
<p>В этом случае математика обеспечивает 128-битную безопасность:</p>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>O(k * 2^(n/(1+lg(k)))
</span><span>k=2^40 accounts
</span><span>n=440
</span><span>2^(40) * 2^(448 * 8 / 41) ~= O(2^(128))
</span></code></pre>










<script src="https://giscus.app/client.js"
    data-repo="dudochkin-victor&#x2F;dudochkin-victor.github.io"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzNzgwNTYx"
    data-category="General"
    data-category-id="DIC_kwDOADmv0c4CAhvj"
    data-mapping="pathname"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async>
</script>



        </div>

        
        
    </main>

    
    <footer>
        <small class="subtext">
            <a href="https://angular-rust.github.io">Dudochkin Victor</a> © 2021
        </small>
    </footer>
    
</body>
<script>
    function highlightNav(heading) {
        let pathname = location.pathname;
        document.querySelectorAll(".toc a").forEach((item) => {
            item.classList.remove("active");
        });
        document.querySelector(".toc a[href$='" + pathname + "#" + heading + "']").classList.add("active");
    }

    let currentHeading = "";
    window.onscroll = function () {
        let h = document.querySelectorAll("h1,h2,h3,h4,h5,h6");
        let elementArr = [];

        h.forEach(item => {
            if (item.id !== "") {
                elementArr[item.id] = item.getBoundingClientRect().top;
            }
        });
        elementArr.sort();
        for (let key in elementArr) {
            if (!elementArr.hasOwnProperty(key)) {
                continue;
            }
            if (elementArr[key] > 0 && elementArr[key] < 300) {
                if (currentHeading !== key) {
                    highlightNav(key);
                    currentHeading = key;
                }
                break;
            }
        }
    }
</script>

</html>
