<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Одноразовые номера устойчивых транзакций | Dudochkin Victor </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="google-site-verification" content="Kepqb6k6uptlwngnHbBVJmqQtwNW8zfHyQBbTXLYAgA" />
    <meta name="yandex-verification" content="8e8bc73c2566b473" />
    <style>
    :root {
        /* Primary theme color */
        /* --primary-color: #121A26; */
        --primary-color: #0f1419;
        /* Primary theme text color */
        /* --primary-text-color: #121A26; */
        --primary-text-color: #0f1419;
        /* Primary theme link color */
        --primary-link-color: #053961;
        /* Secondary color: the background body color */
        --secondary-color: #F0F0F0;
        --secondary-text-color: #1C2834;
        /* Highlight text color of table of content */
        --toc-highlight-text-color: #053961;
    }
</style>
    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-47MMPLLY44"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-47MMPLLY44');
    </script>
    

    
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript" >
        (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
        (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
    
        ym('87064264', "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true
        });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/87064264" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
    
    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/mdl.min.css">
    <link rel="stylesheet" href="https://dudochkin-victor.github.io/style.css">
    
    
</head>

<body>
    
<header class="box-shadow">
    

<a href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;">
    <div class="logo">
        <img src="https://dudochkin-victor.github.io/ferris.png" alt="logo">
        Dudochkin Victor
    </div>
</a>

<nav>
    <!-- 
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;showcases&#x2F;">Showcases</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;changelog&#x2F;">Changelog</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;about&#x2F;">About</a>
     -->

    
        
        <a class="nav-item subtitle-text" href="&#x2F;solana&#x2F;">Solana</a>
        
        <a class="nav-item subtitle-text" href="&#x2F;edgeware&#x2F;">Edgeware</a>
        
        <a class="nav-item subtitle-text" href="&#x2F;blog&#x2F;">Блог</a>
        
        <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;github.com&#x2F;dudochkin-victor">Github</a>
        
    
</nav>

</header>

 
    <main>
        
        
        
        
        
        <div class="toc">
            <div class="toc-sticky">
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/offline-signing/durable-nonce/#primery-ispol-zovaniia">Примеры использования</a>
                </div>
                
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/offline-signing/durable-nonce/#polnomochiia-odnorazovogo-nomera"><small>- Полномочия одноразового номера</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/offline-signing/durable-nonce/#sozdanie-odnorazovoi-uchetnoi-zapisi"><small>- Создание одноразовой учетной записи</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/offline-signing/durable-nonce/#zapros-sokhranennogo-znacheniia-odnorazovogo-nomera"><small>- Запрос сохраненного значения одноразового номера</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/offline-signing/durable-nonce/#rasshirenie-znacheniia-sokhranennogo-odnorazovogo-nomera"><small>- Расширение значения сохраненного одноразового номера</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/offline-signing/durable-nonce/#pokazat-uchetnuiu-zapis-odnorazovogo-nomera"><small>- Показать учетную запись одноразового номера</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/offline-signing/durable-nonce/#vyvod-sredstv-s-odnorazovogo-scheta"><small>- Вывод средств с одноразового счета</small></a>
                </div>
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/offline-signing/durable-nonce/#naznachenie-novykh-polnomochii-uchetnoi-zapisi-nonce"><small>- Назначение новых полномочий учетной записи Nonce</small></a>
                </div>
                
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/offline-signing/durable-nonce/#drugie-komandy-podderzhivaiushchie-ustoichivye-odnorazovye-nomera">Другие команды, поддерживающие устойчивые одноразовые номера</a>
                </div>
                
                
                <div class="toc-item-child">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/offline-signing/durable-nonce/#primer-oplaty-s-ispol-zovaniem-prochnogo-odnorazovogo-nomera"><small>- Пример оплаты с использованием прочного одноразового номера</small></a>
                </div>
                
                
                
            </div>
        </div>
        
        

        <div class="content text">
            
<h1>Одноразовые номера устойчивых транзакций</h1>

<p>Устойчивые одноразовые номера транзакций — это механизм, позволяющий обойти типичный короткий жизненный цикл транзакции <a href="developing/programming-model/transactions.md#recent-blockhash"><code>recent_blockhash</code></a>. Они реализованы в виде программы Solana, о механике которой можно прочитать в <a href="../implemented-proposals/durable-tx-nonces/">предложении</a>.</p>
<h2 id="primery-ispol-zovaniia">Примеры использования</h2>
<p>Полную информацию об использовании CLI-команд с устойчивым одноразовым номером можно найти в <a href="../cli/usage/">справке по CLI</a>.</p>
<h3 id="polnomochiia-odnorazovogo-nomera">Полномочия одноразового номера</h3>
<p>Полномочия над одноразовой учетной записью могут быть дополнительно назначены другой учетной записи. При этом новый орган наследует полный контроль над одноразовой учетной записью от предыдущего органа, включая создателя учетной записи. Эта функция позволяет создавать более сложные механизмы владения учетными записями и производные адреса учетных записей, не связанные с парой ключей. Аргумент <code>--nonce-authority &lt;AUTHORITY_KEYPAIR&gt;</code> используется для указания этой учетной записи и поддерживается следующими командами.</p>
<ul>
<li><code>создать одноразовый аккаунт</code></li>
<li><code>новый одноразовый номер</code></li>
<li><code>снятие с одноразового счета</code></li>
<li><code>авторизовать одноразовый аккаунт</code></li>
</ul>
<h3 id="sozdanie-odnorazovoi-uchetnoi-zapisi">Создание одноразовой учетной записи</h3>
<p>Функция одноразового номера устойчивой транзакции использует учетную запись для хранения следующего значения одноразового номера. Аккаунты с постоянным одноразовым номером должны быть <a href="../implemented-proposals/rent.md#two-tiered-rent-regime">освобождены от арендной платы</a>, поэтому для достижения этого необходимо иметь минимальный баланс.</p>
<p>Учетная запись nonce создается путем создания новой пары ключей, а затем создания учетной записи в цепочке.</p>
<ul>
<li>Команда</li>
</ul>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana-keygen</span><span> new</span><span style="color:#f29718;"> -o</span><span> nonce-keypair.json
</span><span style="color:#ffb454;">solana</span><span> create-nonce-account nonce-keypair.json 1
</span></code></pre>
<ul>
<li>Вывод</li>
</ul>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>2SymGjGV4ksPdpbaqWFiDoBz8okvtiik4KE9cnMQgRHrRLySSdZ6jrEcpPifW4xUpp4z66XM9d9wM48sA7peG2XL
</span></code></pre>
<blockquote>
<p>Чтобы пара ключей оставалась полностью автономной, используйте [инструкции] генерации пары ключей <a href="wallet-guide/paper-wallet/">Paper Wallet</a>(wallet-guide/paper-wallet.md#seed-phrase-generation)</p>
</blockquote>
<blockquote>
<p><a href="../cli/usage.md#solana-create-nonce-account">Полная документация по использованию</a></p>
</blockquote>
<h3 id="zapros-sokhranennogo-znacheniia-odnorazovogo-nomera">Запрос сохраненного значения одноразового номера</h3>
<p>Создание надежной транзакции одноразового номера требует передачи сохраненного значения одноразового номера в качестве значения аргумента <code>--blockhash</code> при подписании и отправке. Получите текущее сохраненное значение nonce с помощью</p>
<ul>
<li>Команда</li>
</ul>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana</span><span> nonce nonce-keypair.json
</span></code></pre>
<ul>
<li>Вывод</li>
</ul>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>8GRipryfxcsxN8mAGjy8zbFo9ezaUsh47TsPzmZbuytU
</span></code></pre>
<blockquote>
<p><a href="../cli/usage.md#solana-get-nonce">Полная документация по использованию</a></p>
</blockquote>
<h3 id="rasshirenie-znacheniia-sokhranennogo-odnorazovogo-nomera">Расширение значения сохраненного одноразового номера</h3>
<p>Хотя обычно это не требуется за пределами более полезной транзакции, сохраненное значение одноразового номера может быть расширено с помощью</p>
<ul>
<li>Команда</li>
</ul>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana</span><span> new-nonce nonce-keypair.json
</span></code></pre>
<ul>
<li>Вывод</li>
</ul>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>44jYe1yPKrjuYDmoFTdgPjg8LFpYyh1PFKJqm5SC1PiSyAL8iw1bhadcAX1SL7KDmREEkmHpYvreKoNv6fZgfvUK
</span></code></pre>
<blockquote>
<p><a href="../cli/usage.md#solana-new-nonce">Полная документация по использованию</a></p>
</blockquote>
<h3 id="pokazat-uchetnuiu-zapis-odnorazovogo-nomera">Показать учетную запись одноразового номера</h3>
<p>Проверьте учетную запись nonce в более удобном для человека формате с помощью</p>
<ul>
<li>Команда</li>
</ul>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana</span><span> nonce-account nonce-keypair.json
</span></code></pre>
<ul>
<li>Вывод</li>
</ul>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>balance: 0.5 SOL
</span><span>minimum balance required: 0.00136416 SOL
</span><span>nonce: DZar6t2EaCFQTbUP4DHKwZ1wT8gCPW2aRfkVWhydkBvS
</span></code></pre>
<blockquote>
<p><a href="../cli/usage.md#solana-nonce-account">Полная документация по использованию</a></p>
</blockquote>
<h3 id="vyvod-sredstv-s-odnorazovogo-scheta">Вывод средств с одноразового счета</h3>
<p>Вывод средств с одноразового счета с помощью</p>
<ul>
<li>Команда</li>
</ul>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana</span><span> withdraw-from-nonce-account nonce-keypair.json </span><span style="font-style:italic;color:#39bae6;">~</span><span>/.config/solana/id.json 0.5
</span></code></pre>
<ul>
<li>Вывод</li>
</ul>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>3foNy1SBqwXSsfSfTdmYKDuhnVheRnKXpoPySiUDBVeDEs6iMVokgqm7AqfTjbk7QBE8mqomvMUMNQhtdMvFLide
</span></code></pre>
<blockquote>
<p>Закройте учетную запись nonce, сняв весь баланс</p>
</blockquote>
<blockquote>
<p><a href="../cli/usage.md#solana-withdraw-from-nonce-account">Полная документация по использованию</a></p>
</blockquote>
<h3 id="naznachenie-novykh-polnomochii-uchetnoi-zapisi-nonce">Назначение новых полномочий учетной записи Nonce</h3>
<p>Переназначить полномочия одноразовой учетной записи после создания с помощью</p>
<ul>
<li>Команда</li>
</ul>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana</span><span> authorize-nonce-account nonce-keypair.json nonce-authority.json
</span></code></pre>
<ul>
<li>Вывод</li>
</ul>
<pre style="background-color:#0f1419;color:#bfbab0;"><code><span>3F9cg4zN9wHxLGx4c3cUKmqpej4oa67QbALmChsJbfxTgTffRiL3iUehVhR9wQmWgPua66jPuAYeL1K2pYYjbNoT
</span></code></pre>
<blockquote>
<p><a href="../cli/usage.md#solana-authorize-nonce-account">Полная документация по использованию</a></p>
</blockquote>
<h2 id="drugie-komandy-podderzhivaiushchie-ustoichivye-odnorazovye-nomera">Другие команды, поддерживающие устойчивые одноразовые номера</h2>
<p>Чтобы использовать устойчивые одноразовые номера с другими подкомандами CLI, необходимо поддерживать два аргумента.</p>
<ul>
<li><code>--nonce</code>, указывает учетную запись, хранящую значение nonce</li>
<li><code>--nonce-authority</code>, указывает необязательный nonce полномочия</li>
</ul>
<p>Следующие подкоманды получили эту обработку до сих пор</p>
<ul>
<li><a href="../cli/usage.md#solana-pay"><code>pay</code></a></li>
<li><a href="../cli/usage.md#solana-delegate-stake"><code>delegate-stake</code></a></li>
<li><a href="../cli/usage.md#solana-deactivate-stake"><code>deactivate-stake</code></a></li>
</ul>
<h3 id="primer-oplaty-s-ispol-zovaniem-prochnogo-odnorazovogo-nomera">Пример оплаты с использованием прочного одноразового номера</h3>
<p>Здесь мы демонстрируем, как Алиса платит Бобу 1 SOL, используя устойчивый одноразовый номер. Процедура одинакова для всех подкоманд, поддерживающих устойчивые одноразовые номера.</p>
<h4 id="sozdanie-uchetnykh-zapisei">- Создание учетных записей</h4>
<p>Сначала нам нужны учетные записи для Алисы, одноразового номера Алисы и Боба.</p>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">$</span><span> solana-keygen new</span><span style="color:#f29718;"> -o</span><span> alice.json
</span><span style="color:#ffb454;">$</span><span> solana-keygen new</span><span style="color:#f29718;"> -o</span><span> nonce.json
</span><span style="color:#ffb454;">$</span><span> solana-keygen new</span><span style="color:#f29718;"> -o</span><span> bob.json
</span></code></pre>
<h4 id="popolnit-schet-alisy">- Пополнить счет Алисы</h4>
<p>Алисе потребуются средства, чтобы создать одноразовую учетную запись и отправить ее Бобу. Раздайте ей немного SOL</p>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">$</span><span> solana airdrop</span><span style="color:#f29718;"> -k</span><span> alice.json 1
</span><span style="color:#ffb454;">1</span><span> SOL
</span></code></pre>
<h4 id="sozdat-odnorazovyi-akkaunt-alisy">- Создать одноразовый аккаунт Алисы</h4>
<p>Теперь Алисе нужна одноразовая учетная запись. Создай</p>
<blockquote>
<p>Здесь не используется отдельный nonce полномочие, поэтому alice.json имеет полные права доступа к учетной записи nonce</p>
</blockquote>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">$</span><span> solana create-nonce-account</span><span style="color:#f29718;"> -k</span><span> alice.json nonce.json 0.1
</span><span style="color:#ffb454;">3KPZr96BTsL3hqera9up82KAU462Gz31xjqJ6eHUAjF935Yf8i1kmfEbo6SVbNaACKE5z6gySrNjVRvmS8DcPuwV
</span></code></pre>
<h4 id="neudachnaia-pervaia-popytka-zaplatit-bobu">- Неудачная первая попытка заплатить Бобу</h4>
<p>Алиса пытается заплатить Бобу, но подписывает слишком долго. Срок действия указанного хэша истекает, и транзакция не выполняется.</p>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">$</span><span> solana pay</span><span style="color:#f29718;"> -k</span><span> alice.json</span><span style="color:#f29718;"> --blockhash</span><span> expiredDTaxfagttWjQweib42b6ZHADSx94Tw8gHx3W7 bob.json 0.01
</span><span style="color:#ffb454;">[2020-01-02T18:48:28.462911000Z</span><span> ERROR solana_cli::cli] Io(Custom { kind: Other</span><span style="color:#bfbab0cc;">,</span><span> error: </span><span style="color:#c2d94c;">&quot;Transaction </span><span style="color:#95e6cb;">\&quot;</span><span style="color:#c2d94c;">33gQQaoPc9jWePMvDAeyJpcnSPiGUAdtVg8zREWv4GiKjkcGNufgpcbFyRKRrA25NkgjZySEeKue5rawyeH5TzsV</span><span style="color:#95e6cb;">\&quot;</span><span style="color:#c2d94c;"> failed: None&quot; </span><span>})
</span><span style="color:#ffb454;">Error:</span><span> Io(Custom { kind: Other</span><span style="color:#bfbab0cc;">,</span><span> error: </span><span style="color:#c2d94c;">&quot;Transaction </span><span style="color:#95e6cb;">\&quot;</span><span style="color:#c2d94c;">33gQQaoPc9jWePMvDAeyJpcnSPiGUAdtVg8zREWv4GiKjkcGNufgpcbFyRKRrA25NkgjZySEeKue5rawyeH5TzsV</span><span style="color:#95e6cb;">\&quot;</span><span style="color:#c2d94c;"> failed: None&quot; </span><span>})
</span></code></pre>
<h4 id="nonsens-na-pomoshch">- Нонсенс на помощь!</h4>
<p>Алиса повторяет транзакцию, на этот раз указывая свою учетную запись nonce и хранящийся там блокхеш.</p>
<blockquote>
<p>Помните, что в этом примере <code>alice.json</code> — это nonce Authority</p>
</blockquote>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">$</span><span> solana nonce-account nonce.json
</span><span style="color:#ffb454;">balance:</span><span> 0.1 SOL
</span><span style="color:#ffb454;">minimum</span><span> balance required: 0.00136416 SOL
</span><span style="color:#ffb454;">nonce:</span><span> F7vmkY3DTaxfagttWjQweib42b6ZHADSx94Tw8gHx3W7
</span></code></pre>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">$</span><span> solana pay</span><span style="color:#f29718;"> -k</span><span> alice.json</span><span style="color:#f29718;"> --blockhash</span><span> F7vmkY3DTaxfagttWjQweib42b6ZHADSx94Tw8gHx3W7</span><span style="color:#f29718;"> --nonce</span><span> nonce.json bob.json 0.01
</span><span style="color:#ffb454;">HR1368UKHVZyenmH7yVz5sBAijV6XAPeWbEiXEGVYQorRMcoijeNAbzZqEZiH8cDB8tk65ckqeegFjK8dHwNFgQ
</span></code></pre>
<h4 id="uspekh">- Успех!</h4>
<p>Сделка прошла успешно! Боб получает 0,01 SOL от Алисы, и сохраненный одноразовый номер Алисы изменяется на новое значение.</p>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">$</span><span> solana balance</span><span style="color:#f29718;"> -k</span><span> bob.json
</span><span style="color:#ffb454;">0.01</span><span> SOL
</span></code></pre>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">$</span><span> solana nonce-account nonce.json
</span><span style="color:#ffb454;">balance:</span><span> 0.1 SOL
</span><span style="color:#ffb454;">minimum</span><span> balance required: 0.00136416 SOL
</span><span style="color:#ffb454;">nonce:</span><span> 6bjroqDcZgTv6Vavhqf81oBHTv3aMnX19UTB51YhAZnN
</span></code></pre>










<script src="https://giscus.app/client.js"
    data-repo="dudochkin-victor&#x2F;dudochkin-victor.github.io"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzNzgwNTYx"
    data-category="General"
    data-category-id="DIC_kwDOADmv0c4CAhvj"
    data-mapping="pathname"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async>
</script>



        </div>

        
        
    </main>

    
    <footer>
        <small class="subtext">
            <a href="https://angular-rust.github.io">Dudochkin Victor</a> © 2021
        </small>
    </footer>
    
</body>
<script>
    function highlightNav(heading) {
        let pathname = location.pathname;
        document.querySelectorAll(".toc a").forEach((item) => {
            item.classList.remove("active");
        });
        document.querySelector(".toc a[href$='" + pathname + "#" + heading + "']").classList.add("active");
    }

    let currentHeading = "";
    window.onscroll = function () {
        let h = document.querySelectorAll("h1,h2,h3,h4,h5,h6");
        let elementArr = [];

        h.forEach(item => {
            if (item.id !== "") {
                elementArr[item.id] = item.getBoundingClientRect().top;
            }
        });
        elementArr.sort();
        for (let key in elementArr) {
            if (!elementArr.hasOwnProperty(key)) {
                continue;
            }
            if (elementArr[key] > 0 && elementArr[key] < 300) {
                if (currentHeading !== key) {
                    highlightNav(key);
                    currentHeading = key;
                }
                break;
            }
        }
    }
</script>

</html>
