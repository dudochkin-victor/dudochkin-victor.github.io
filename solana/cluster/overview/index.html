<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Кластер Solana | Dudochkin Victor </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="google-site-verification" content="Kepqb6k6uptlwngnHbBVJmqQtwNW8zfHyQBbTXLYAgA" />
    <meta name="yandex-verification" content="8e8bc73c2566b473" />
    <style>
    :root {
        /* Primary theme color */
        /* --primary-color: #121A26; */
        --primary-color: #0f1419;
        /* Primary theme text color */
        /* --primary-text-color: #121A26; */
        --primary-text-color: #0f1419;
        /* Primary theme link color */
        --primary-link-color: #053961;
        /* Secondary color: the background body color */
        --secondary-color: #F0F0F0;
        --secondary-text-color: #1C2834;
        /* Highlight text color of table of content */
        --toc-highlight-text-color: #053961;
    }
</style>
    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-47MMPLLY44"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-47MMPLLY44');
    </script>
    

    
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript" >
        (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
        (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
    
        ym('87064264', "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true
        });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/87064264" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
    
    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/mdl.min.css">
    <link rel="stylesheet" href="https://dudochkin-victor.github.io/style.css">
    
    
</head>

<body>
    
<header class="box-shadow">
    

<a href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;">
    <div class="logo">
        <img src="https://dudochkin-victor.github.io/ferris.png" alt="logo">
        Dudochkin Victor
    </div>
</a>

<nav>
    <!-- 
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;showcases&#x2F;">Showcases</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;changelog&#x2F;">Changelog</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;about&#x2F;">About</a>
     -->

    
        
        <a class="nav-item subtitle-text" href="&#x2F;solana&#x2F;">Solana</a>
        
        <a class="nav-item subtitle-text" href="&#x2F;edgeware&#x2F;">Edgeware</a>
        
        <a class="nav-item subtitle-text" href="&#x2F;blog&#x2F;">Блог</a>
        
        <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;github.com&#x2F;dudochkin-victor">Github</a>
        
    
</nav>

</header>

 
    <main>
        
        
        
        
        
        <div class="toc">
            <div class="toc-sticky">
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/cluster/overview/#sozdanie-klastera">Создание кластера</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/cluster/overview/#prisoedinenie-k-klasteru">Присоединение к кластеру</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/cluster/overview/#otpravka-tranzaktsii-v-klaster">Отправка транзакций в кластер</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/cluster/overview/#podtverzhdenie-tranzaktsii">Подтверждение транзакций</a>
                </div>
                
                
            </div>
        </div>
        
        

        <div class="content text">
            
<h1>Кластер Solana</h1>

<p>Кластер Solana — это набор валидаторов, работающих вместе для обслуживания клиентских транзакций и поддержания целостности леджера. Многие кластеры могут сосуществовать. Когда два кластера имеют общий генезисный блок, они пытаются сойтись. В противном случае они просто игнорируют существование другого. Транзакции, отправленные не на тот адрес, спокойно отклоняются. В этом разделе мы обсудим, как создается кластер, как узлы присоединяются к кластеру, как они совместно используют реестр, как они обеспечивают репликацию реестра и как они справляются с глючными и вредоносными узлами.</p>
<h2 id="sozdanie-klastera">Создание кластера</h2>
<p>Прежде чем запускать какие-либо валидаторы, сначала необходимо создать <em>genesis config</em>. Конфигурация ссылается на два открытых ключа, <em>mint</em> и <em>bootstrap validator</em>. Валидатор, содержащий закрытый ключ валидатора начальной загрузки, отвечает за добавление первых записей в реестр. Он инициализирует свое внутреннее состояние учетной записью монетного двора. Эта учетная запись будет содержать количество собственных токенов, определенное конфигурацией генезиса. Затем второй валидатор связывается с валидатором начальной загрузки, чтобы зарегистрироваться как <em>валидатор</em>. Затем дополнительные валидаторы регистрируются у любого зарегистрированного члена кластера.</p>
<p>Валидатор получает все записи от лидера и отправляет голоса, подтверждающие, что эти записи действительны. Ожидается, что после голосования валидатор сохранит эти записи. Как только валидатор обнаруживает, что существует достаточное количество копий, он удаляет свою копию.</p>
<h2 id="prisoedinenie-k-klasteru">Присоединение к кластеру</h2>
<p>Валидаторы входят в кластер через регистрационные сообщения, отправленные на его <em>control plane</em>. Плоскость управления реализована с использованием протокола <em>gossip</em>, что означает, что узел может зарегистрироваться на любом существующем узле и ожидать, что его регистрация распространится на все узлы в кластере. Время, необходимое для синхронизации всех узлов, пропорционально квадрату числа узлов, участвующих в кластере. Алгоритмически это считается очень медленным, но в обмен на это время узлу гарантируется, что он в конечном итоге будет иметь всю ту же информацию, что и любой другой узел, и что эта информация не может быть подвергнута цензуре ни одним узлом.</p>
<h2 id="otpravka-tranzaktsii-v-klaster">Отправка транзакций в кластер</h2>
<p>Клиенты отправляют транзакции на любой порт модуля обработки транзакций (TPU) валидатора. Если узел находится в роли валидатора, он перенаправляет транзакцию назначенному лидеру. Если в роли лидера узел объединяет входящие транзакции, помечает их временными метками, создавая <em>entry</em>, и помещает их на <em>плоскость_данных</em> кластера. Оказавшись в плоскости данных, транзакции проверяются узлами валидации, эффективно добавляя их в реестр.</p>
<h2 id="podtverzhdenie-tranzaktsii">Подтверждение транзакций</h2>
<p>Кластер Solana способен выполнять <em>подтверждение</em> за доли секунды для тысяч узлов с планами масштабирования до сотен тысяч узлов. Ожидается, что время подтверждения будет увеличиваться только с логарифмом числа валидаторов, где основание логарифма очень велико. Например, если база равна одной тысяче, это означает, что для первой тысячи узлов подтверждением будет продолжительность трех сетевых переходов плюс время, необходимое для голосования самому медленному валидатору из подавляющего большинства. Для следующего миллиона узлов подтверждение увеличивается только на один сетевой переход.</p>
<p>Солана определяет подтверждение как продолжительность времени с момента, когда лидер отмечает новую запись, до момента, когда он признает подавляющее большинство голосов в реестре.</p>
<p>Масштабируемое подтверждение может быть достигнуто с использованием следующей комбинации методов:</p>
<ol>
<li>
<p>Отметьте транзакции с помощью образца VDF и подпишите отметку времени.</p>
</li>
<li>
<p>Разделите транзакции на пакеты, отправьте каждую на отдельные узлы, чтобы каждый узел делился своим пакетом со своими одноранговыми узлами.</p>
</li>
<li>
<p>Повторяйте предыдущий шаг рекурсивно, пока все узлы не будут иметь все пакеты.</p>
</li>
</ol>
<p>Солана меняет лидеров через фиксированные промежутки времени, называемые <em>slots</em>. Каждый лидер может производить записи только в течение отведенного ему слота. Таким образом, лидер ставит метки времени транзакций, чтобы валидаторы могли найти открытый ключ назначенного лидера. Затем лидер подписывает метку времени, чтобы валидатор мог проверить подпись, доказывая, что подписывающая сторона является владельцем открытого ключа назначенного лидера.</p>
<p>Затем транзакции разбиваются на пакеты, чтобы узел мог отправлять транзакции нескольким сторонам, не создавая нескольких копий. Если, например, лидеру необходимо отправить 60 транзакций на 6 узлов, он разобьет эту коллекцию из 60 на пакеты по 10 транзакций и отправит по одной на каждый узел. Это позволяет лидеру передавать по сети 60 транзакций, а не 60 транзакций для каждого узла. Затем каждый узел делится своим пакетом со своими одноранговыми узлами. Как только узел соберет все 6 пакетов, он реконструирует исходный набор из 60 транзакций.</p>
<p>Пакет транзакций можно разделить столько раз, прежде чем он станет настолько мал, что информация заголовка станет основным потребителем пропускной способности сети. На момент написания этой статьи (декабрь 2021 г.) подход хорошо масштабируется примерно до 1250 валидаторов. Для масштабирования до сотен тысяч валидаторов каждый узел может применять ту же технику, что и узел-лидер, к другому набору узлов равного размера. Мы называем эту технику <a href="turbine-block-propagation/"><em>Turbine Block Propogation</em></a>.</p>










<script src="https://giscus.app/client.js"
    data-repo="dudochkin-victor&#x2F;dudochkin-victor.github.io"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzNzgwNTYx"
    data-category="General"
    data-category-id="DIC_kwDOADmv0c4CAhvj"
    data-mapping="pathname"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async>
</script>



        </div>

        
        
    </main>

    
    <footer>
        <small class="subtext">
            <a href="https://angular-rust.github.io">Dudochkin Victor</a> © 2021
        </small>
    </footer>
    
</body>
<script>
    function highlightNav(heading) {
        let pathname = location.pathname;
        document.querySelectorAll(".toc a").forEach((item) => {
            item.classList.remove("active");
        });
        document.querySelector(".toc a[href$='" + pathname + "#" + heading + "']").classList.add("active");
    }

    let currentHeading = "";
    window.onscroll = function () {
        let h = document.querySelectorAll("h1,h2,h3,h4,h5,h6");
        let elementArr = [];

        h.forEach(item => {
            if (item.id !== "") {
                elementArr[item.id] = item.getBoundingClientRect().top;
            }
        });
        elementArr.sort();
        for (let key in elementArr) {
            if (!elementArr.hasOwnProperty(key)) {
                continue;
            }
            if (elementArr[key] > 0 && elementArr[key] < 300) {
                if (currentHeading !== key) {
                    highlightNav(key);
                    currentHeading = key;
                }
                break;
            }
        }
    }
</script>

</html>
