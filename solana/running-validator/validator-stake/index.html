<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Стэйкинг | Dudochkin Victor </title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="google-site-verification" content="Kepqb6k6uptlwngnHbBVJmqQtwNW8zfHyQBbTXLYAgA" />
    <meta name="yandex-verification" content="8e8bc73c2566b473" />
    <style>
    :root {
        /* Primary theme color */
        /* --primary-color: #121A26; */
        --primary-color: #0f1419;
        /* Primary theme text color */
        /* --primary-text-color: #121A26; */
        --primary-text-color: #0f1419;
        /* Primary theme link color */
        --primary-link-color: #053961;
        /* Secondary color: the background body color */
        --secondary-color: #F0F0F0;
        --secondary-text-color: #1C2834;
        /* Highlight text color of table of content */
        --toc-highlight-text-color: #053961;
    }
</style>
    
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-47MMPLLY44"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-47MMPLLY44');
    </script>
    

    
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript" >
        (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
        (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");
    
        ym('87064264', "init", {
            clickmap:true,
            trackLinks:true,
            accurateTrackBounce:true
        });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/87064264" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
    
    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/mdl.min.css">
    <link rel="stylesheet" href="https://dudochkin-victor.github.io/style.css">
    
    
</head>

<body>
    
<header class="box-shadow">
    

<a href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;">
    <div class="logo">
        <img src="https://dudochkin-victor.github.io/ferris.png" alt="logo">
        Dudochkin Victor
    </div>
</a>

<nav>
    <!-- 
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;showcases&#x2F;">Showcases</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;changelog&#x2F;">Changelog</a>
    
    <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;dudochkin-victor.github.io&#x2F;about&#x2F;">About</a>
     -->

    
        
        <a class="nav-item subtitle-text" href="&#x2F;solana&#x2F;">Solana</a>
        
        <a class="nav-item subtitle-text" href="&#x2F;edgeware&#x2F;">Edgeware</a>
        
        <a class="nav-item subtitle-text" href="&#x2F;blog&#x2F;">Блог</a>
        
        <a class="nav-item subtitle-text" href="https:&#x2F;&#x2F;github.com&#x2F;dudochkin-victor">Github</a>
        
    
</nav>

</header>

 
    <main>
        
        
        
        
        
        <div class="toc">
            <div class="toc-sticky">
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/running-validator/validator-stake/#monitoring-naverstyvaniia">Мониторинг наверстывания</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/running-validator/validator-stake/#sozdat-paru-kliuchei-doli">Создать пару ключей доли</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/running-validator/validator-stake/#delegirovat-stavku">Делегировать ставку</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/running-validator/validator-stake/#razogrev-doli-validatora">Разогрев доли валидатора</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/running-validator/validator-stake/#otslezhivaite-svoi-steiking-validator">Отслеживайте свой стейкинг-валидатор</a>
                </div>
                
                
                <div class="toc-item">
                    <a class="subtext" href="https://dudochkin-victor.github.io/solana/running-validator/validator-stake/#deaktivatsiia-stavki">Деактивация ставки</a>
                </div>
                
                
            </div>
        </div>
        
        

        <div class="content text">
            
<h1>Стэйкинг</h1>

<p><strong>По умолчанию у вашего валидатора не будет доли.</strong> Это означает, что он не сможет стать лидером.</p>
<h2 id="monitoring-naverstyvaniia">Мониторинг наверстывания</h2>
<p>Чтобы делегировать долю, сначала убедитесь, что ваш валидатор работает и догнал кластер. Может потребоваться некоторое время, чтобы наверстать упущенное после загрузки вашего валидатора.
Используйте команду <code>catchup</code> для мониторинга вашего валидатора в ходе этого процесса:</p>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana</span><span> catchup </span><span style="font-style:italic;color:#39bae6;">~</span><span>/validator-keypair.json
</span></code></pre>
<p>Пока ваш валидатор не подтянется, он не сможет успешно проголосовать и делегировать ему ставку.</p>
<p>Кроме того, если вы обнаружите, что слот кластера продвигается быстрее, чем ваш, вы, вероятно, никогда не догоните его. Обычно это подразумевает какую-то проблему с сетью между вашим валидатором и остальной частью кластера.</p>
<h2 id="sozdat-paru-kliuchei-doli">Создать пару ключей доли</h2>
<p>Если вы еще этого не сделали, создайте пару ключей для ставок. Если вы выполнили этот шаг, вы должны увидеть «validator-stake-keypair.json» в каталоге среды выполнения Solana.</p>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana-keygen</span><span> new</span><span style="color:#f29718;"> -o </span><span style="font-style:italic;color:#39bae6;">~</span><span>/validator-stake-keypair.json
</span></code></pre>
<h2 id="delegirovat-stavku">Делегировать ставку</h2>
<p>Теперь делегируйте 1 SOL вашему валидатору, предварительно создав свою учетную запись:</p>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana</span><span> create-stake-account </span><span style="font-style:italic;color:#39bae6;">~</span><span>/validator-stake-keypair.json 1
</span></code></pre>
<p>а затем делегировать эту долю вашему валидатору:</p>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana</span><span> delegate-stake </span><span style="font-style:italic;color:#39bae6;">~</span><span>/validator-stake-keypair.json </span><span style="font-style:italic;color:#39bae6;">~</span><span>/vote-account-keypair.json
</span></code></pre>
<blockquote>
<p>Не делегируйте оставшийся SOL, так как ваш валидатор будет использовать эти токены для голосования.</p>
</blockquote>
<p>Ставки могут быть повторно делегированы другому узлу в любое время с помощью той же команды, но разрешено только одно повторное делегирование в каждую эпоху:</p>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana</span><span> delegate-stake </span><span style="font-style:italic;color:#39bae6;">~</span><span>/validator-stake-keypair.json </span><span style="font-style:italic;color:#39bae6;">~</span><span>/some-other-vote-account-keypair.json
</span></code></pre>
<p>Предполагая, что узел голосует, теперь вы готовы к работе и генерируете вознаграждение валидатора. Награды выплачиваются автоматически на границах эпох.</p>
<p>Награды, полученные лампортами, распределяются между вашей учетной записью доли и учетной записью для голосования в соответствии с комиссией, установленной в учетной записи для голосования. Вознаграждения можно получить только тогда, когда валидатор запущен и работает. Кроме того, после стейкинга валидатор становится важной частью сети. Чтобы безопасно удалить валидатора из сети, сначала деактивируйте его стейк.</p>
<p>Ожидается, что в конце каждого слота валидатор отправит транзакцию голосования.
Эти голосовые транзакции оплачиваются лампортами из учетной записи удостоверения личности валидатора.</p>
<p>Это обычная транзакция, поэтому будет применяться стандартная комиссия за транзакцию. Диапазон комиссии за транзакцию определяется блоком генезиса. Фактическая комиссия будет колебаться в зависимости от загрузки транзакции. Вы можете определить текущую комиссию через <a href="developing/clients/jsonrpc-api.md#getrecentblockhash">RPC API «getRecentBlockhash»</a> перед отправкой транзакции.</p>
<p>Узнайте больше о <a href="../implemented-proposals/transaction-fees/">комиссиях за транзакции здесь</a>.</p>
<h2 id="razogrev-doli-validatora">Разогрев доли валидатора</h2>
<p>Чтобы бороться с различными атаками на консенсус, делегирование новых кольев подлежит <a href="/staking/stake-accounts#delegation-warmup-and-cooldown">разминке</a>.</p>
<p>Следите за ставкой валидатора во время прогрева:</p>
<ul>
<li>Просмотрите свою учетную запись для голосования: <code>solana voice-account ~/vote-account-keypair.json</code> Здесь отображается текущее состояние всех голосов, отправленных валидатором в сеть.</li>
<li>Просмотрите свою учетную запись доли, предпочтения делегирования и сведения о вашей ставке: <code>солана стейк-аккаунт ~/validator-stake-keypair.json</code></li>
<li><code>солана валидаторы</code> отображает текущую активную ставку всех валидаторов, в том числе и вашего</li>
<li>«История кольев Солана» показывает историю нагрева и остывания кола в последние эпохи.</li>
<li>Найдите сообщения в журнале вашего валидатора, указывающие на ваш следующий слот лидера: <code>[2019-09-27T20:16:00.319721164Z INFO solana_core::replay_stage] &lt;VALIDATOR_IDENTITY_PUBKEY&gt; проголосовал и сбросил PoH на высоте тика ####. Мой следующий слот лидера - ####</code></li>
<li>Как только ваша ставка будет разогрета, вы увидите баланс ставки, указанный для вашего валидатора, запустив <code>solana validators</code></li>
</ul>
<h2 id="otslezhivaite-svoi-steiking-validator">Отслеживайте свой стейкинг-валидатор</h2>
<p>Подтвердите, что ваш валидатор становится <a href="../terminology.md#leader">лидером</a></p>
<ul>
<li>После того, как ваш валидатор пойман, используйте команду <code>solana balance</code> для отслеживания доходов, поскольку ваш валидатор выбран в качестве лидера и собирает комиссию за транзакции.</li>
<li>Узлы Solana предлагают ряд полезных методов JSON-RPC для возврата информации о сети и участии вашего валидатора. Сделайте запрос с помощью curl(или другого http-клиента по вашему выбору), указав нужный метод в данных в формате JSON-RPC. Например:</li>
</ul>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span>  </span><span style="color:#ffb454;">//</span><span> Request
</span><span>  </span><span style="color:#ffb454;">curl</span><span style="color:#f29718;"> -X</span><span> POST</span><span style="color:#f29718;"> -H </span><span style="color:#c2d94c;">&quot;Content-Type: application/json&quot;</span><span style="color:#f29718;"> -d </span><span style="color:#c2d94c;">&#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;id&quot;:1, &quot;method&quot;:&quot;getEpochInfo&quot;}&#39;</span><span> http://localhost:8899
</span><span>
</span><span>  </span><span style="color:#ffb454;">//</span><span> Result
</span><span>  </span><span style="color:#ffb454;">{</span><span style="color:#c2d94c;">&quot;jsonrpc&quot;</span><span style="color:#ffb454;">:</span><span style="color:#c2d94c;">&quot;2.0&quot;</span><span style="color:#ffb454;">,</span><span style="color:#c2d94c;">&quot;result&quot;</span><span style="color:#ffb454;">:{</span><span style="color:#c2d94c;">&quot;epoch&quot;</span><span style="color:#ffb454;">:3,</span><span style="color:#c2d94c;">&quot;slotIndex&quot;</span><span style="color:#ffb454;">:126,</span><span style="color:#c2d94c;">&quot;slotsInEpoch&quot;</span><span style="color:#ffb454;">:256</span><span>}</span><span style="color:#ffb454;">,</span><span style="color:#c2d94c;">&quot;id&quot;</span><span style="color:#ffb454;">:1</span><span>}
</span></code></pre>
<p>Полезные методы JSON-RPC:</p>
<ul>
<li><code>getEpochInfo</code><a href="../terminology.md#epoch">Эпоха</a> – это время, т.е. количество <a href="../terminology.md#slot">слотов</a>, для которых [лидерное расписание](../ termology.md#leader-schedule) действителен. Это скажет вам, что такое текущая эпоха и как далеко в ней находится кластер.</li>
<li><code>getVoteAccounts</code> Это скажет вам, сколько активной доли у вашего валидатора в настоящее время. % ставки валидатора активируется на границе эпохи. Вы можете узнать больше о стекинге на Solana <a href="../cluster/stake-delegation-and-rewards/">здесь</a>.</li>
<li><code>getLeaderSchedule</code> В любой момент сеть ожидает, что только один валидатор создаст записи в бухгалтерской книге. <a href="../cluster/leader-rotation.md#leader-rotation">Валидатор, выбранный в настоящее время для создания записей реестра</a> называется «лидером». Это вернет полное расписание лидера (на основе слота за слотом) для текущей активированной доли, публичный ключ идентификации будет отображаться здесь 1 или более раз.</li>
</ul>
<h2 id="deaktivatsiia-stavki">Деактивация ставки</h2>
<p>Прежде чем отсоединить ваш валидатор от кластера, вы должны деактивировать ранее делегированный стейк, выполнив:</p>
<pre data-lang="bash" style="background-color:#0f1419;color:#bfbab0;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#ffb454;">solana</span><span> deactivate-stake </span><span style="font-style:italic;color:#39bae6;">~</span><span>/validator-stake-keypair.json
</span></code></pre>
<p>Ставка не деактивируется сразу, а вместо этого остывает так же, как разогревается. Ваш валидатор должен оставаться подключенным к кластеру, пока ставка остывает. Во время охлаждения ваша ставка будет продолжать приносить вознаграждение. Только после остывания стейка можно безопасно отключить валидатор или вывести его из сети. Перезарядка может занять несколько эпох, в зависимости от активной ставки и размера вашей ставки.</p>
<p>Обратите внимание, что учетную запись для ставок можно использовать только один раз, поэтому после деактивации используйте команду cli <code>withdraw-stake</code> для восстановления ранее поставленных лампортов.</p>










<script src="https://giscus.app/client.js"
    data-repo="dudochkin-victor&#x2F;dudochkin-victor.github.io"
    data-repo-id="MDEwOlJlcG9zaXRvcnkzNzgwNTYx"
    data-category="General"
    data-category-id="DIC_kwDOADmv0c4CAhvj"
    data-mapping="pathname"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async>
</script>



        </div>

        
        
    </main>

    
    <footer>
        <small class="subtext">
            <a href="https://angular-rust.github.io">Dudochkin Victor</a> © 2021
        </small>
    </footer>
    
</body>
<script>
    function highlightNav(heading) {
        let pathname = location.pathname;
        document.querySelectorAll(".toc a").forEach((item) => {
            item.classList.remove("active");
        });
        document.querySelector(".toc a[href$='" + pathname + "#" + heading + "']").classList.add("active");
    }

    let currentHeading = "";
    window.onscroll = function () {
        let h = document.querySelectorAll("h1,h2,h3,h4,h5,h6");
        let elementArr = [];

        h.forEach(item => {
            if (item.id !== "") {
                elementArr[item.id] = item.getBoundingClientRect().top;
            }
        });
        elementArr.sort();
        for (let key in elementArr) {
            if (!elementArr.hasOwnProperty(key)) {
                continue;
            }
            if (elementArr[key] > 0 && elementArr[key] < 300) {
                if (currentHeading !== key) {
                    highlightNav(key);
                    currentHeading = key;
                }
                break;
            }
        }
    }
</script>

</html>
